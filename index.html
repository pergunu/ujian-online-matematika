<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ujian Online PERGUNU Situbondo</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --color-primary: #6a11cb;
            --color-secondary: #2575fc;
            --color-tertiary: #00c6fb;
            --color-success: #4CAF50;
            --color-error: #f44336;
            --color-warning: #ff9800;
            --color-info: #2196F3;
            --color-dark: #1a1a2e;
            --color-light: #f8f9fa;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--color-primary), var(--color-secondary), var(--color-tertiary));
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Particle Background */
        #particles-js {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
        }

        #celebration-particles {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 1000;
            pointer-events: none;
            display: none;
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        .header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
        }

        .logo {
            height: 80px;
            margin-bottom: 15px;
        }

        /* Card Styles */
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        }

        /* Button Styles */
        .btn {
            display: inline-block;
            padding: 12px 25px;
            border-radius: 50px;
            background: linear-gradient(to right, var(--color-secondary), var(--color-tertiary));
            color: white;
            text-decoration: none;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(37, 117, 252, 0.3);
            margin: 5px;
            text-align: center;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(37, 117, 252, 0.4);
        }

        .btn:active {
            transform: translateY(1px);
        }

        .btn-success {
            background: linear-gradient(to right, var(--color-success), #2ecc71);
        }

        .btn-danger {
            background: linear-gradient(to right, var(--color-error), #e74c3c);
        }

        .btn-warning {
            background: linear-gradient(to right, var(--color-warning), #f39c12);
        }

        .btn-info {
            background: linear-gradient(to right, var(--color-info), #3498db);
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--color-secondary);
            background: rgba(255, 255, 255, 0.2);
            box-shadow: 0 0 0 3px rgba(37, 117, 252, 0.2);
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        /* Radio and Checkbox Styles */
        .radio-group, .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .radio-option, .checkbox-option {
            display: none;
        }

        .radio-label, .checkbox-label {
            padding: 10px 20px;
            border-radius: 50px;
            background: rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .radio-option:checked + .radio-label,
        .checkbox-option:checked + .checkbox-label {
            background: linear-gradient(to right, var(--color-secondary), var(--color-tertiary));
            box-shadow: 0 4px 15px rgba(37, 117, 252, 0.3);
        }

        /* Animation Classes */
        .slide-in {
            animation: slideIn 0.5s forwards;
        }

        .slide-out {
            animation: slideOut 0.5s forwards;
        }

        .fade-in {
            animation: fadeIn 0.5s forwards;
        }

        .fade-out {
            animation: fadeOut 0.5s forwards;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(-100%); opacity: 0; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        /* Timer Styles */
        .timer {
            font-size: 24px;
            font-weight: 700;
            text-align: center;
            margin: 20px 0;
            color: white;
            transition: all 0.3s ease;
        }

        .timer-warning {
            color: var(--color-warning);
            font-size: 28px;
        }

        .timer-danger {
            color: var(--color-error);
            font-size: 32px;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Notification Styles */
        .notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            z-index: 1000;
            animation: slideUp 0.5s forwards;
            max-width: 90%;
            text-align: center;
        }

        @keyframes slideUp {
            from { bottom: -50px; opacity: 0; }
            to { bottom: 20px; opacity: 1; }
        }

        /* Question Styles */
        .question-container {
            margin-bottom: 30px;
        }

        .question {
            font-size: 18px;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }

        .option {
            padding: 15px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .option.correct {
            background: var(--color-success);
            animation: correctAnswer 0.5s;
        }

        .option.incorrect {
            background: var(--color-error);
            animation: incorrectAnswer 0.5s;
        }

        @keyframes correctAnswer {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes incorrectAnswer {
            0% { transform: translateX(0); }
            20% { transform: translateX(-10px); }
            40% { transform: translateX(10px); }
            60% { transform: translateX(-10px); }
            80% { transform: translateX(10px); }
            100% { transform: translateX(0); }
        }

        .explanation {
            margin-top: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            display: none;
        }

        /* Certificate Styles - REVISED FOR PRINTING */
        .certificate {
            background: white;
            color: #333;
            padding: 0;
            border-radius: 0;
            box-shadow: none;
            width: 210mm; /* A4 width */
            height: 297mm; /* A4 height */
            margin: 20px auto;
            position: relative;
            overflow: hidden;
            background-image: url('https://raw.githubusercontent.com/pergunu/ujian-online/main/assets/images/certificate.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            display: flex;
            flex-direction: column;
            justify-content: center;
            page-break-after: avoid;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        .certificate-content {
            position: relative;
            z-index: 1;
            text-align: center;
            padding: 40px 60px;
            margin: 0 auto;
            width: 80%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .certificate-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--color-primary);
            text-transform: uppercase;
        }

        .certificate-code {
            font-size: 14px;
            margin-bottom: 30px;
            color: #555;
            letter-spacing: 1px;
        }

        .certificate-recipient {
            font-size: 48px;
            margin: 20px 0;
            font-weight: 600;
            color: #333;
            font-family: 'Dancing Script', cursive;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .certificate-body {
            font-size: 16px;
            line-height: 1.6;
            margin: 10px 0;
            color: #333;
        }

        .certificate-score {
            font-size: 28px;
            font-weight: 700;
            color: var(--color-primary);
            margin: 20px 0;
        }

        .certificate-motivation {
            font-style: italic;
            margin: 15px 0;
            font-size: 14px;
            color: #555;
        }

        .certificate-footer {
            margin-top: 30px;
            font-size: 12px;
            color: #555;
        }

        .certificate-signature {
            margin-top: 40px;
            font-size: 14px;
        }

        .certificate-barcode {
            margin: 15px auto;
            height: 80px;
            width: auto;
        }

        /* Floating Button Styles */
        .floating-buttons {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 100;
        }

        .floating-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(to right, var(--color-secondary), var(--color-tertiary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }

        .floating-btn:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }

        .floating-btn .tooltip {
            position: absolute;
            right: 60px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 14px;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .floating-btn:hover .tooltip {
            opacity: 1;
            right: 70px;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            color: #333;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: modalFadeIn 0.3s;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--color-primary);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        /* Roman numeral styles */
        .roman {
            font-family: 'Times New Roman', serif;
            font-style: italic;
        }

        /* Print Styles - REVISED FOR BETTER PRINTING */
        @media print {
            body * {
                visibility: hidden;
                background: white !important;
                color: black !important;
            }
            
            .certificate, 
            .certificate * {
                visibility: visible;
                background: transparent !important;
                color: #333 !important;
            }
            
            .certificate {
                position: absolute;
                left: 0;
                top: 0;
                width: 210mm !important;
                height: 297mm !important;
                margin: 0 !important;
                padding: 0 !important;
                box-shadow: none !important;
                border-radius: 0 !important;
                background-image: url('https://raw.githubusercontent.com/pergunu/ujian-online/main/assets/images/certificate.png') !important;
                background-size: cover !important;
                background-position: center !important;
                background-repeat: no-repeat !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                page-break-after: avoid !important;
                page-break-inside: avoid !important;
            }
            
            .certificate-content {
                padding: 40px 60px !important;
                margin: 0 auto !important;
                width: 80% !important;
                height: 100% !important;
                display: flex !important;
                flex-direction: column !important;
                justify-content: center !important;
            }
            
            .certificate-recipient {
                font-size: 48px !important;
                font-family: 'Dancing Script', cursive !important;
            }
            
            .floating-buttons, 
            .results-summary, 
            .result-actions {
                display: none !important;
            }
            
            @page {
                size: A4 portrait;
                margin: 0;
            }
        }

        /* Responsive Styles */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .card {
                padding: 20px;
            }
            
            .certificate-content {
                padding: 30px;
                width: 90%;
            }
            
            .certificate-title {
                font-size: 24px;
            }
            
            .certificate-recipient {
                font-size: 36px;
            }
            
            .floating-buttons {
                bottom: 20px;
                right: 20px;
            }
            
            .floating-btn {
                width: 45px;
                height: 45px;
                font-size: 18px;
            }

            .modal-content {
                width: 95%;
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            .btn {
                padding: 10px 20px;
                font-size: 14px;
            }
            
            .form-control {
                padding: 10px 12px;
                font-size: 14px;
            }
            
            .certificate-content {
                padding: 20px;
                width: 95%;
            }
            
            .certificate-title {
                font-size: 20px;
            }
            
            .certificate-recipient {
                font-size: 28px;
            }
        }

        /* Admin Panel Specific Styles */
        .admin-section {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }

        .admin-section h5 {
            color: var(--color-primary);
            margin-bottom: 15px;
            font-size: 18px;
        }

        .admin-controls {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .admin-control-group {
            margin-bottom: 15px;
        }

        .admin-control-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            font-size: 14px;
        }

        .admin-control-input {
            width: 100%;
            padding: 10px 12px;
            border-radius: 6px;
            border: 1px solid #ddd;
            font-size: 14px;
        }

        .admin-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--color-success);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        .participant-list {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 10px;
        }

        .participant-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            font-size: 14px;
        }

        .participant-item:last-child {
            border-bottom: none;
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        /* Question Bank Styles */
        .questions-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 10px;
        }

        .question-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            font-size: 14px;
            position: relative;
        }

        .question-item:last-child {
            border-bottom: none;
        }

        .question-actions {
            position: absolute;
            right: 10px;
            top: 10px;
            display: flex;
            gap: 5px;
        }

        .question-action-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 14px;
            padding: 2px 5px;
            border-radius: 3px;
        }

        .edit-btn {
            color: var(--color-info);
        }

        .delete-btn {
            color: var(--color-error);
        }

        .options-container {
            display: grid;
            gap: 5px;
        }

        /* Loading Indicator */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0,0,0,.3);
            border-radius: 50%;
            border-top-color: var(--color-primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Table Styles */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 14px;
        }

        .data-table th, .data-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .data-table th {
            background-color: #f5f5f5;
            font-weight: 600;
        }

        .data-table tr:hover {
            background-color: #f9f9f9;
        }

        /* Checkbox styles for participant selection */
        .select-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .select-all-checkbox {
            margin-right: 5px;
        }

        .participant-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        /* Search Box */
        .search-box {
            margin-bottom: 15px;
        }

        .search-input {
            width: 100%;
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
            font-size: 14px;
        }

        /* Edit Question Modal */
        .edit-question-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .edit-question-content {
            background: white;
            color: #333;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .edit-question-close {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        /* Edit Participant Modal */
        .edit-participant-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .edit-participant-content {
            background: white;
            color: #333;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .edit-participant-close {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        /* Certificate Validation Section */
        .certificate-validation {
            margin-top: 20px;
            padding: 15px;
            background-color: #f5f5f5;
            border-radius: 8px;
        }

        .validation-result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }

        .valid-certificate {
            background-color: #dff0d8;
            color: #3c763d;
        }

        .invalid-certificate {
            background-color: #f2dede;
            color: #a94442;
        }

        /* Question Image Preview */
        .question-image-preview {
            max-width: 100%;
            max-height: 200px;
            margin-top: 10px;
            display: none;
        }

        /* File Input Customization */
        .file-input-container {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-input-button {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 10px 15px;
            background-color: #f5f5f5;
            color: #333;
            cursor: pointer;
            display: block;
            text-align: center;
            transition: all 0.3s;
        }

        .file-input-button:hover {
            background-color: #e9e9e9;
        }

        .file-input {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-info {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }

        /* Alert Styles */
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            font-size: 14px;
        }

        .alert-success {
            background-color: #dff0d8;
            color: #3c763d;
            border: 1px solid #d6e9c6;
        }

        .alert-danger {
            background-color: #f2dede;
            color: #a94442;
            border: 1px solid #ebccd1;
        }

        /* Question Level Badge */
        .level-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            margin-right: 5px;
        }

        .level-sd {
            background-color: #f0ad4e;
            color: white;
        }

        .level-smp {
            background-color: #5bc0de;
            color: white;
        }

        .level-sma {
            background-color: #5cb85c;
            color: white;
        }
    </style>
</head>
<body>
    <div id="particles-js"></div>
    <div id="celebration-particles"></div>
    
    <div class="container">
        <!-- Welcome Screen -->
        <div id="welcome-screen" class="card slide-in">
            <div class="header">
                <img src="https://raw.githubusercontent.com/pergunu/ujian-online/main/assets/images/logo.png" alt="PERGUNU Logo" class="logo">
                <h1>Ujian Online PERGUNU Situbondo</h1>
            </div>
            
            <div id="greeting-message">
                <p id="greeting-text">Selamat datang di sistem ujian online PERGUNU Situbondo, Sistem tes kemampuan akademik untuk pelajar. Silakan masukkan kode login untuk melanjutkan.</p>
            </div>
            
            <div class="form-group">
                <label for="login-code" class="form-label">Kode Login</label>
                <input type="password" id="login-code" class="form-control" placeholder="Masukkan kode login">
                <small class="text-muted">Kode login diberikan oleh admin</small>
            </div>
            
            <button id="login-btn" class="btn">Masuk</button>
        </div>
        
        <!-- Terms Screen (Hidden Initially) -->
        <div id="terms-screen" class="card" style="display: none;">
            <h2>Peraturan dan Kebijakan Ujian Online</h2>
            <div class="terms-content" style="max-height: 300px; overflow-y: auto; margin: 20px 0; padding: 15px; background: rgba(0, 0, 0, 0.1); border-radius: 8px;">
                <p>1. Ujian ini dikembangkan oleh Cendhanu Tim Kreator PERGUNU Situbondo.</p>
                <p>2. Peserta wajib mengisi data diri dengan benar dan lengkap.</p>
                <p>3. Dilarang keras melakukan kecurangan selama ujian berlangsung.</p>
                <p>4. Waktu ujian akan berjalan terus dan tidak dapat dihentikan.</p>
                <p>5. Jawaban yang sudah dipilih tidak dapat diubah.</p>
                <p>6. Soal yang tidak dijawab akan dianggap salah.</p>
                <p>7. Hasil ujian akan ditampilkan setelah waktu habis atau peserta menyelesaikan ujian.</p>
                <p>8. Sertifikat akan diberikan kepada peserta yang menyelesaikan ujian.</p>
                <p>9. Keputusan panitia ujian bersifat mutlak dan tidak dapat diganggu gugat.</p>
            </div>
            
            <div class="form-group">
                <input type="checkbox" id="agree-terms" class="checkbox-option">
                <label for="agree-terms" class="checkbox-label">Saya menyetujui</label>
            </div>
            
            <button id="continue-btn" class="btn" disabled>Lanjut Ikut Ujian</button>
        </div>
        
        <!-- Participant Form (Hidden Initially) -->
        <div id="participant-form" class="card" style="display: none;">
            <h2>Formulir Data Peserta</h2>
            <p>Silakan isi data diri Anda dengan benar. Data ini akan digunakan untuk sertifikat ujian.</p>
            
            <div class="form-group">
                <label for="fullname" class="form-label">Nama Lengkap</label>
                <input type="text" id="fullname" class="form-control" placeholder="Masukkan nama lengkap" pattern="[A-Za-z ]+" title="Hanya huruf diperbolehkan" required>
            </div>
            
            <div class="form-group">
                <label class="form-label">Status</label>
                <div class="radio-group">
                    <input type="radio" id="status-student" name="status" value="pelajar" class="radio-option" checked>
                    <label for="status-student" class="radio-label">Pelajar</label>
                </div>
            </div>
            
            <!-- Student Fields -->
            <div id="student-fields">
                <div class="form-group">
                    <label for="school-name" class="form-label">Nama Sekolah</label>
                    <input type="text" id="school-name" class="form-control" placeholder="Masukkan nama sekolah">
                </div>
                
                <div class="form-group">
                    <label for="student-id" class="form-label">NIS (Nomor Induk Siswa)</label>
                    <input type="text" id="student-id" class="form-control" placeholder="Masukkan NIS" pattern="[0-9]+" title="Hanya angka diperbolehkan" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Tujuan Ikut Ujian</label>
                    <div class="radio-group">
                        <input type="radio" id="purpose-task" name="purpose" value="Tugas Sekolah" class="radio-option">
                        <label for="purpose-task" class="radio-label">Tugas Sekolah</label>
                        
                        <input type="radio" id="purpose-exam" name="purpose" value="Tugas Ulangan" class="radio-option">
                        <label for="purpose-exam" class="radio-label">Tugas Ulangan</label>
                        
                        <input type="radio" id="purpose-test" name="purpose" value="Tes dan Belajar" class="radio-option">
                        <label for="purpose-test" class="radio-label">Tes dan Belajar</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Tingkat Sekolah</label>
                    <div class="radio-group">
                        <input type="radio" id="level-elementary" name="level" value="SD" class="radio-option">
                        <label for="level-elementary" class="radio-label">SD</label>
                        
                        <input type="radio" id="level-junior" name="level" value="SMP" class="radio-option">
                        <label for="level-junior" class="radio-label">SMP</label>
                        
                        <input type="radio" id="level-senior" name="level" value="SMA/SMK" class="radio-option">
                        <label for="level-senior" class="radio-label">SMA/SMK</label>
                    </div>
                </div>
            </div>
            
            <!-- Grade Selection (Will be shown based on school level) -->
            <div id="grade-selection" style="display: none;">
                <div class="form-group">
                    <label class="form-label">Kelas</label>
                    <div class="radio-group" id="grade-options">
                        <!-- Options will be populated by JavaScript -->
                    </div>
                </div>
            </div>
            
            <!-- Subject Selection -->
            <div id="subject-selection" style="display: none;">
                <div class="form-group">
                    <label class="form-label">Pilih Jenis Ujian</label>
                    <div class="radio-group">
                        <input type="radio" id="subject-science" name="subject" value="IPA" class="radio-option">
                        <label for="subject-science" class="radio-label">IPA</label>
                        
                        <input type="radio" id="subject-social" name="subject" value="IPS" class="radio-option">
                        <label for="subject-social" class="radio-label">IPS</label>
                    </div>
                </div>
            </div>
            
            <!-- Admin Information -->
            <div class="form-group" id="admin-info" style="margin-top: 30px;">
                <p>Informasi berkala dari admin:</p>
                <div style="padding: 15px; background: rgba(0, 0, 0, 0.1); border-radius: 8px;">
                    <p id="admin-message">Tidak ada informasi terbaru saat ini.</p>
                </div>
            </div>
            
            <button id="save-participant-btn" class="btn" disabled>Simpan & Ikut Ujian</button>
        </div>
        
        <!-- Exam Screen (Hidden Initially) -->
        <div id="exam-screen" class="card" style="display: none;">
            <div class="timer" id="exam-timer">02:00:00</div>
            
            <div class="question-container">
                <div class="question" id="question-text">Memuat soal...</div>
                <div id="question-image-container" style="margin-bottom: 15px;"></div>
                
                <div class="options" id="options-container">
                    <!-- Options will be populated by JavaScript -->
                </div>
                
                <div class="explanation" id="explanation-text">
                    <!-- Explanation will be populated by JavaScript -->
                </div>
            </div>
            
            <div class="exam-controls">
                <button id="finish-exam-btn" class="btn btn-danger">Selesaikan Ujian Sekarang</button>
                <button id="skip-question-btn" class="btn btn-warning">Lewati Soal</button>
                <button id="unanswered-btn" class="btn btn-info">Soal Belum Dijawab</button>
            </div>
        </div>
        
        <!-- Results Screen (Hidden Initially) -->
        <div id="results-screen" class="card" style="display: none;">
            <h2>Hasil Ujian</h2>
            
            <div class="results-summary">
                <p>Nama: <span id="result-name"></span></p>
                <p>Status: <span id="result-status"></span></p>
                <p>Tingkat: <span id="result-level"></span></p>
                <p>Kelas: <span id="result-grade"></span></p>
                <p>Mata Ujian: <span id="result-subject"></span></p>
                <p>Jumlah Soal: <span id="total-questions"></span></p>
                <p>Jawaban Benar: <span id="correct-answers"></span></p>
                <p>Jawaban Salah: <span id="wrong-answers"></span></p>
                <p>Tidak Dijawab: <span id="unanswered-questions"></span></p>
                <p>Nilai: <span id="exam-score"></span></p>
            </div>
            
            <div class="certificate-container" id="certificate-container" style="display: none;">
                <!-- Certificate will be generated here -->
            </div>
            
            <div class="result-actions">
                <button id="print-certificate-btn" class="btn btn-success">Cetak Sertifikat</button>
                <button id="retake-exam-btn" class="btn btn-info">Ulangi Ujian</button>
            </div>
        </div>
    </div>
    
    <!-- Floating Buttons -->
    <div class="floating-buttons">
        <button class="floating-btn" id="whatsapp-btn">
            <i class="fab fa-whatsapp"></i>
            <span class="tooltip">Chat Admin</span>
        </button>
        
        <button class="floating-btn" id="question-bank-btn">
            <i class="fas fa-book"></i>
            <span class="tooltip">Bank Soal</span>
        </button>
        
        <button class="floating-btn" id="admin-panel-btn">
            <i class="fas fa-cog"></i>
            <span class="tooltip">Admin Panel</span>
        </button>
    </div>
    
    <!-- Modals -->
    <!-- Question Bank Modal -->
    <div class="modal" id="question-bank-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Bank Soal</h3>
                <button class="modal-close" id="close-question-bank-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="question-bank-code" class="form-label">Kode Bank Soal</label>
                    <input type="password" id="question-bank-code" class="form-control" placeholder="Masukkan kode bank soal" style="color: #333;">
                    <button id="submit-question-bank-code" class="btn">Masuk</button>
                </div>
                
                <div id="question-bank-content" style="display: none;">
                    <h4>Bank Soal</h4>
                    <div class="admin-section">
                        <h5>Tambah Soal Baru</h5>
                        <div class="form-group">
                            <label class="form-label">Tingkat Sekolah</label>
                            <select id="question-level" class="form-control" style="color: #333;">
                                <option value="SD">SD</option>
                                <option value="SMP">SMP</option>
                                <option value="SMA/SMK">SMA/SMK</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Kategori Ujian</label>
                            <select id="question-category" class="form-control" style="color: #333;">
                                <option value="IPA">IPA</option>
                                <option value="IPS">IPS</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Pertanyaan</label>
                            <textarea id="question-text-input" class="form-control" rows="3" style="color: #333;"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Gambar Soal (Opsional, maks. 500KB)</label>
                            <div class="file-input-container">
                                <label class="file-input-button">
                                    <i class="fas fa-upload"></i> Pilih Gambar
                                    <input type="file" id="question-image" class="file-input" accept="image/*">
                                </label>
                                <div class="file-input-info">Format: JPG, PNG, GIF. Maksimal 500KB</div>
                            </div>
                            <img id="question-image-preview" class="question-image-preview" src="#" alt="Preview Gambar Soal">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Opsi Jawaban</label>
                            <div class="options-container">
                                <input type="text" id="option-a" class="form-control" placeholder="Opsi A" style="color: #333; margin-bottom: 5px;">
                                <input type="text" id="option-b" class="form-control" placeholder="Opsi B" style="color: #333; margin-bottom: 5px;">
                                <input type="text" id="option-c" class="form-control" placeholder="Opsi C" style="color: #333; margin-bottom: 5px;">
                                <input type="text" id="option-d" class="form-control" placeholder="Opsi D" style="color: #333; margin-bottom: 5px;">
                                <input type="text" id="option-e" class="form-control" placeholder="Opsi E" style="color: #333;">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Jawaban Benar</label>
                            <select id="correct-answer" class="form-control" style="color: #333;">
                                <option value="0">A</option>
                                <option value="1">B</option>
                                <option value="2">C</option>
                                <option value="3">D</option>
                                <option value="4">E</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Penjelasan</label>
                            <textarea id="explanation-input" class="form-control" rows="3" style="color: #333;"></textarea>
                        </div>
                        <button id="add-question-btn" class="btn btn-success">Tambah Soal</button>
                        <div id="add-question-alert" class="alert" style="display: none;"></div>
                    </div>
                    
                    <div class="admin-section">
                        <h5>Daftar Soal</h5>
                        <div class="form-group">
                            <div class="admin-controls">
                                <div class="admin-control-group">
                                    <label class="admin-control-label">Filter Tingkat</label>
                                    <select id="filter-level" class="admin-control-input" style="color: #333;">
                                        <option value="all">Semua Tingkat</option>
                                        <option value="SD">SD</option>
                                        <option value="SMP">SMP</option>
                                        <option value="SMA/SMK">SMA/SMK</option>
                                    </select>
                                </div>
                                <div class="admin-control-group">
                                    <label class="admin-control-label">Filter Kategori</label>
                                    <select id="filter-category" class="admin-control-input" style="color: #333;">
                                        <option value="all">Semua Kategori</option>
                                        <option value="IPA">IPA</option>
                                        <option value="IPS">IPS</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="questions-list">
                            <!-- Questions will be loaded here -->
                            <p id="no-questions-message">Belum ada soal yang tersedia.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Admin Panel Modal -->
    <div class="modal" id="admin-panel-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Kontrol Panel Admin</h3>
                <button class="modal-close" id="close-admin-panel-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="admin-panel-code" class="form-label">Kode Admin</label>
                    <input type="password" id="admin-panel-code" class="form-control" placeholder="Masukkan kode admin" style="color: #333;">
                    <button id="submit-admin-panel-code" class="btn">Masuk</button>
                </div>
                
                <div id="admin-panel-content" style="display: none;">
                    <div class="admin-section">
                        <h5>Pengaturan Kode</h5>
                        <div class="form-group">
                            <label class="form-label">Kode Login Baru</label>
                            <input type="password" id="new-login-code" class="form-control" placeholder="Masukkan kode login baru" style="color: #333;">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Kode Bank Soal Baru</label>
                            <input type="password" id="new-question-bank-code" class="form-control" placeholder="Masukkan kode bank soal baru" style="color: #333;">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Kode Admin Baru</label>
                            <input type="password" id="new-admin-code" class="form-control" placeholder="Masukkan kode admin baru" style="color: #333;">
                        </div>
                        
                        <button id="save-codes-btn" class="btn btn-success">Simpan Kode</button>
                    </div>
                    
                    <div class="admin-section">
                        <h5>Pengaturan Ujian</h5>
                        <div class="admin-controls">
                            <div class="admin-control-group">
                                <label class="admin-control-label">Durasi Ujian (menit)</label>
                                <input type="number" id="exam-duration" class="admin-control-input" value="120" min="5" max="300">
                            </div>
                            <div class="admin-control-group">
                                <label class="admin-control-label">Jumlah Soal</label>
                                <select id="question-count" class="admin-control-input">
                                    <option value="5">5</option>
                                    <option value="10">10</option>
                                    <option value="15">15</option>
                                    <option value="20">20</option>
                                    <option value="25">25</option>
                                    <option value="30">30</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                    <option value="150">150</option>
                                </select>
                            </div>
                        </div>
                        <div class="admin-control-group">
                            <label class="admin-control-label">Acak Soal</label>
                            <div class="admin-toggle">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="randomize-questions" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span id="randomize-status">Aktif</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="admin-section">
                        <h5>Pengaturan Konten</h5>
                        <div class="form-group">
                            <label class="form-label">Pesan Pembuka</label>
                            <textarea id="greeting-message-input" class="form-control" rows="3" style="color: #333;">Selamat datang di sistem ujian online PERGUNU Situbondo. Silakan masukkan kode login untuk melanjutkan.</textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Pesan Informasi Berkala</label>
                            <textarea id="admin-message-input" class="form-control" rows="3" style="color: #333;">Tidak ada informasi terbaru saat ini.</textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Nama Ketua PERGUNU</label>
                            <input type="text" id="chairman-name" class="form-control" value="Moh. Nuril Hudha, S.Pd., M.Si." style="color: #333;">
                        </div>
                        <button id="save-content-btn" class="btn btn-success">Simpan Perubahan</button>
                    </div>
                    
                    <div class="admin-section">
                        <h5>Manajemen Peserta</h5>
                        <div class="search-box">
                            <input type="text" id="participant-search" class="search-input" placeholder="Cari peserta berdasarkan nama, NIS, atau kode sertifikat...">
                        </div>
                        <div class="participant-actions">
                            <button id="select-all-participants" class="btn btn-info">
                                <input type="checkbox" id="select-all-checkbox" class="select-all-checkbox">
                                Pilih Semua
                            </button>
                            <button id="edit-selected-participants" class="btn btn-warning" disabled>
                                <i class="fas fa-edit"></i> Edit Terpilih
                            </button>
                            <button id="delete-selected-participants" class="btn btn-danger" disabled>
                                <i class="fas fa-trash"></i> Hapus Terpilih
                            </button>
                        </div>
                        <div class="participant-list">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th width="30px">
                                            <!-- Select all checkbox -->
                                        </th>
                                        <th>Tanggal</th>
                                        <th>Nama</th>
                                        <th>NIS</th>
                                        <th>Status</th>
                                        <th>Tingkat</th>
                                        <th>Kelas</th>
                                        <th>Mata Ujian</th>
                                        <th>Nilai</th>
                                        <th>Kode Sertifikat</th>
                                    </tr>
                                </thead>
                                <tbody id="participants-table-body">
                                    <!-- Participant data will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="admin-section">
                        <h5>Validasi Sertifikat</h5>
                        <div class="certificate-validation">
                            <div class="form-group">
                                <label class="form-label">Masukkan Kode Sertifikat</label>
                                <input type="text" id="certificate-code-input" class="form-control" placeholder="Masukkan kode sertifikat" style="color: #333;">
                                <button id="validate-certificate-btn" class="btn btn-info">Validasi</button>
                            </div>
                            <div id="validation-result" class="validation-result" style="display: none;">
                                <!-- Validation result will be shown here -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="admin-section">
                        <h5>Aktifkan/Nonaktifkan Ujian</h5>
                        <div class="admin-controls">
                            <div class="admin-control-group">
                                <label class="admin-control-label">IPA</label>
                                <div class="admin-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="toggle-science" checked>
                                        <span class="toggle-slider"></span>
                                    </label>
                                    <span id="science-status">Aktif</span>
                                </div>
                            </div>
                            <div class="admin-control-group">
                                <label class="admin-control-label">IPS</label>
                                <div class="admin-toggle">
                                    <label class="toggle-switch">
                                        <input type="checkbox" id="toggle-social" checked>
                                        <span class="toggle-slider"></span>
                                    </label>
                                    <span id="social-status">Aktif</span>
                                </div>
                            </div>
                        </div>
                        <button id="save-settings-btn" class="btn btn-success">Simpan Pengaturan</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Edit Question Modal -->
    <div class="edit-question-modal" id="edit-question-modal">
        <div class="edit-question-content">
            <span class="edit-question-close" id="close-edit-question-modal">&times;</span>
            <h3>Edit Soal</h3>
            
            <div class="form-group">
                <label class="form-label">Tingkat Sekolah</label>
                <select id="edit-question-level" class="form-control" style="color: #333;">
                    <option value="SD">SD</option>
                    <option value="SMP">SMP</option>
                    <option value="SMA/SMK">SMA/SMK</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Kategori Ujian</label>
                <select id="edit-question-category" class="form-control" style="color: #333;">
                    <option value="IPA">IPA</option>
                    <option value="IPS">IPS</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Pertanyaan</label>
                <textarea id="edit-question-text" class="form-control" rows="3" style="color: #333;"></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Gambar Soal (Opsional, maks. 500KB)</label>
                <div class="file-input-container">
                    <label class="file-input-button">
                        <i class="fas fa-upload"></i> Pilih Gambar
                        <input type="file" id="edit-question-image" class="file-input" accept="image/*">
                    </label>
                    <div class="file-input-info">Format: JPG, PNG, GIF. Maksimal 500KB</div>
                </div>
                <img id="edit-question-image-preview" class="question-image-preview" src="#" alt="Preview Gambar Soal">
            </div>
            <div class="form-group">
                <label class="form-label">Opsi Jawaban</label>
                <div class="options-container">
                    <input type="text" id="edit-option-a" class="form-control" placeholder="Opsi A" style="color: #333; margin-bottom: 5px;">
                    <input type="text" id="edit-option-b" class="form-control" placeholder="Opsi B" style="color: #333; margin-bottom: 5px;">
                    <input type="text" id="edit-option-c" class="form-control" placeholder="Opsi C" style="color: #333; margin-bottom: 5px;">
                    <input type="text" id="edit-option-d" class="form-control" placeholder="Opsi D" style="color: #333; margin-bottom: 5px;">
                    <input type="text" id="edit-option-e" class="form-control" placeholder="Opsi E" style="color: #333;">
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Jawaban Benar</label>
                <select id="edit-correct-answer" class="form-control" style="color: #333;">
                    <option value="0">A</option>
                    <option value="1">B</option>
                    <option value="2">C</option>
                    <option value="3">D</option>
                    <option value="4">E</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Penjelasan</label>
                <textarea id="edit-explanation" class="form-control" rows="3" style="color: #333;"></textarea>
            </div>
            
            <div class="form-group" style="display: flex; justify-content: space-between;">
                <button id="save-edit-question-btn" class="btn btn-success">Simpan Perubahan</button>
                <button id="delete-question-btn" class="btn btn-danger">Hapus Soal</button>
            </div>
            
            <input type="hidden" id="edit-question-index">
            <input type="hidden" id="edit-question-original-level">
            <input type="hidden" id="edit-question-original-category">
        </div>
    </div>
    
    <!-- Edit Participant Modal -->
    <div class="edit-participant-modal" id="edit-participant-modal">
        <div class="edit-participant-content">
            <span class="edit-participant-close" id="close-edit-participant-modal">&times;</span>
            <h3>Edit Data Peserta</h3>
            
            <div class="form-group">
                <label for="edit-fullname" class="form-label">Nama Lengkap</label>
                <input type="text" id="edit-fullname" class="form-control" style="color: #333;" pattern="[A-Za-z ]+" title="Hanya huruf diperbolehkan" required>
            </div>
            
            <div class="form-group">
                <label class="form-label">Status</label>
                <div class="radio-group">
                    <input type="radio" id="edit-status-student" name="edit-status" value="pelajar" class="radio-option" checked>
                    <label for="edit-status-student" class="radio-label">Pelajar</label>
                </div>
            </div>
            
            <div id="edit-student-fields">
                <div class="form-group">
                    <label for="edit-school-name" class="form-label">Nama Sekolah</label>
                    <input type="text" id="edit-school-name" class="form-control" style="color: #333;">
                </div>
                
                <div class="form-group">
                    <label for="edit-student-id" class="form-label">NIS (Nomor Induk Siswa)</label>
                    <input type="text" id="edit-student-id" class="form-control" style="color: #333;" pattern="[0-9]+" title="Hanya angka diperbolehkan" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Tujuan Ikut Ujian</label>
                    <div class="radio-group">
                        <input type="radio" id="edit-purpose-task" name="edit-purpose" value="Tugas Sekolah" class="radio-option">
                        <label for="edit-purpose-task" class="radio-label">Tugas Sekolah</label>
                        
                        <input type="radio" id="edit-purpose-exam" name="edit-purpose" value="Tugas Ulangan" class="radio-option">
                        <label for="edit-purpose-exam" class="radio-label">Tugas Ulangan</label>
                        
                        <input type="radio" id="edit-purpose-test" name="edit-purpose" value="Tes dan Belajar" class="radio-option">
                        <label for="edit-purpose-test" class="radio-label">Tes dan Belajar</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Tingkat Sekolah</label>
                    <div class="radio-group">
                        <input type="radio" id="edit-level-elementary" name="edit-level" value="SD" class="radio-option">
                        <label for="edit-level-elementary" class="radio-label">SD</label>
                        
                        <input type="radio" id="edit-level-junior" name="edit-level" value="SMP" class="radio-option">
                        <label for="edit-level-junior" class="radio-label">SMP</label>
                        
                        <input type="radio" id="edit-level-senior" name="edit-level" value="SMA/SMK" class="radio-option">
                        <label for="edit-level-senior" class="radio-label">SMA/SMK</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Kelas</label>
                    <div class="radio-group" id="edit-grade-options">
                        <!-- Options will be populated by JavaScript -->
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">Mata Ujian</label>
                <select id="edit-subject" class="form-control" style="color: #333;">
                    <option value="IPA">IPA</option>
                    <option value="IPS">IPS</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="edit-score" class="form-label">Nilai</label>
                <input type="number" id="edit-score" class="form-control" min="0" max="100" style="color: #333;">
            </div>
            
            <div class="form-group">
                <label for="edit-certificate-code" class="form-label">Kode Sertifikat</label>
                <input type="text" id="edit-certificate-code" class="form-control" style="color: #333;" readonly>
            </div>
            
            <button id="save-edit-participant-btn" class="btn btn-success">Simpan Perubahan</button>
            
            <input type="hidden" id="edit-participant-index">
        </div>
    </div>
    
    <!-- Notification -->
    <div class="notification" id="time-warning" style="display: none;">
        Perhatian! Ujian akan berakhir dalam waktu 10 menit. Mohon pastikan semua jawaban telah diselesaikan dan diperiksa sebelum waktu habis. Terima kasih atas partisipasi Anda.
    </div>

    <!-- Audio Elements -->
    <audio id="button-sound" src="https://github.com/pergunu/pergunusmart/raw/main/assets/audio/audiotombol.mp3" preload="auto"></audio>
    <audio id="correct-answer-sound" src="https://github.com/pergunu/pergunusmart/raw/main/assets/audio/jawabanbenar.mp3" preload="auto"></audio>
    <audio id="wrong-answer-sound" src="https://github.com/pergunu/pergunusmart/raw/main/assets/audio/jawabansalah.mp3" preload="auto"></audio>
    <audio id="certificate-sound" src="https://github.com/pergunu/pergunusmart/raw/main/assets/audio/applause.mp3" preload="auto"></audio>
    <audio id="opening-sound" src="https://github.com/pergunu/ujian-online/raw/main/assets/audio/opening.mp3" preload="auto"></audio>

    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script>
        // Global variables
        let currentScreen = 'welcome';
        let participantData = {};
        let examData = {};
        let questions = [];
        let currentQuestionIndex = 0;
        let answeredQuestions = {};
        let examTimer;
        let examTimeLeft = 120 * 60; // 120 minutes in seconds
        let selectedParticipants = [];
        
        // Audio elements
        const buttonSound = document.getElementById('button-sound');
        const correctAnswerSound = document.getElementById('correct-answer-sound');
        const wrongAnswerSound = document.getElementById('wrong-answer-sound');
        const certificateSound = document.getElementById('certificate-sound');
        const openingSound = document.getElementById('opening-sound');
        
        // Default codes (should be changed in production)
        const DEFAULT_LOGIN_CODE = '12345';
        const DEFAULT_QUESTION_BANK_CODE = 'OPENLOCK-1926';
        const DEFAULT_ADMIN_PANEL_CODE = '65614222';
        
        // Store participants data
        let participantsData = JSON.parse(localStorage.getItem('participantsData')) || [];
        
        // Store admin settings
        let adminSettings = JSON.parse(localStorage.getItem('adminSettings')) || {
            loginCode: DEFAULT_LOGIN_CODE,
            questionBankCode: DEFAULT_QUESTION_BANK_CODE,
            adminCode: DEFAULT_ADMIN_PANEL_CODE,
            examDuration: 120,
            questionCount: 20,
            randomizeQuestions: true,
            greetingMessage: "Selamat datang di sistem ujian online PERGUNU Situbondo. Silakan masukkan kode login untuk melanjutkan.",
            adminMessage: "Tidak ada informasi terbaru saat ini.",
            chairmanName: "Moh. Nuril Hudha, S.Pd., M.Si.",
            enabledSubjects: {
                IPA: true,
                IPS: true
            }
        };
        
        // Question bank structure with levels
        // Update the QUESTION_BANK variable in the existing code with this content
let QUESTION_BANK = {
    'SD': {
        'IPA': [
            {
                question: "Perhatikan pernyataan berikut tentang ciri-ciri makhluk hidup: 1) Bernapas, 2) Tumbuh, 3) Bergerak, 4) Berkembang biak. Manakah yang merupakan ciri utama yang membedakan makhluk hidup dengan benda mati?",
                options: [
                    "A. Hanya 1 dan 2",
                    "B. Hanya 3 dan 4",
                    "C. Hanya 1, 2, dan 3",
                    "D. Semua benar (1, 2, 3, dan 4)",
                    "E. Hanya 4 saja"
                ],
                correctAnswer: 3,
                explanation: "Semua pernyataan (bernapas, tumbuh, bergerak, dan berkembang biak) adalah ciri-ciri makhluk hidup yang membedakannya dari benda mati. Benda mati tidak memiliki kemampuan untuk melakukan keempat hal tersebut secara alami."
            },
            {
                question: "Pada proses fotosintesis, tumbuhan hijau mengubah karbon dioksida dan air menjadi glukosa dan oksigen dengan bantuan cahaya matahari. Manakah organel sel yang bertanggung jawab atas proses ini?",
                options: [
                    "A. Mitokondria",
                    "B. Kloroplas",
                    "C. Nukleus",
                    "D. Ribosom",
                    "E. Vakuola"
                ],
                correctAnswer: 1,
                explanation: "Kloroplas adalah organel sel tumbuhan yang mengandung klorofil, pigmen hijau yang menyerap energi cahaya untuk digunakan dalam proses fotosintesis. Mitokondria berperan dalam respirasi sel, bukan fotosintesis."
            },
            {
                question: "Perhatikan rantai makanan berikut: Padi  Tikus  Ular  Elang. Jika populasi ular berkurang drastis karena perburuan liar, apa yang mungkin terjadi pada ekosistem tersebut?",
                options: [
                    "A. Populasi tikus akan menurun",
                    "B. Populasi elang akan meningkat",
                    "C. Populasi padi akan menurun",
                    "D. Populasi elang akan menurun",
                    "E. Tidak ada pengaruh pada ekosistem"
                ],
                correctAnswer: 2,
                explanation: "Jika populasi ular berkurang, maka populasi tikus (mangsa ular) akan meningkat karena berkurangnya predator. Peningkatan populasi tikus akan menyebabkan lebih banyak padi yang dimakan, sehingga populasi padi akan menurun."
            },
            {
                question: "Bumi melakukan dua jenis gerakan sekaligus, yaitu rotasi dan revolusi. Manakah pernyataan yang benar tentang akibat dari gerakan rotasi Bumi?",
                options: [
                    "A. Terjadinya siang dan malam",
                    "B. Perubahan musim",
                    "C. Perbedaan lamanya siang dan malam",
                    "D. Gerak semu tahunan matahari",
                    "E. Perubahan posisi rasi bintang"
                ],
                correctAnswer: 0,
                explanation: "Rotasi Bumi adalah perputaran Bumi pada porosnya yang menyebabkan terjadinya siang dan malam. Perubahan musim dan perbedaan lamanya siang dan malam disebabkan oleh revolusi Bumi mengelilingi Matahari dan kemiringan sumbu Bumi."
            },
            {
                question: "Perhatikan gambar rangka manusia! Tulang yang termasuk dalam kelompok tulang anggota gerak atas adalah...",
                options: [
                    "A. Tulang belakang dan tulang rusuk",
                    "B. Tulang paha dan tulang kering",
                    "C. Tulang lengan atas dan tulang hasta",
                    "D. Tulang tengkorak dan tulang belikat",
                    "E. Tulang selangka dan tulang dada"
                ],
                correctAnswer: 2,
                explanation: "Tulang anggota gerak atas terdiri dari tulang lengan atas (humerus), tulang hasta (ulna), tulang pengumpil (radius), tulang pergelangan tangan (karpal), tulang telapak tangan (metakarpal), dan tulang jari-jari (falanges)."
            },
            {
                question: "Dalam suatu percobaan, seorang siswa menanam biji kacang hijau dalam tiga pot dengan perlakuan berbeda: Pot A disiram setiap hari, Pot B disiram dua hari sekali, Pot C tidak disiram sama sekali. Setelah seminggu, hasil pengamatan menunjukkan tanaman di Pot A tumbuh subur, Pot B tumbuh kurang subur, dan Pot C tidak tumbuh. Variabel bebas dalam percobaan ini adalah...",
                options: [
                    "A. Jenis biji yang ditanam",
                    "B. Frekuensi penyiraman",
                    "C. Pertumbuhan tanaman",
                    "D. Ukuran pot yang digunakan",
                    "E. Intensitas cahaya"
                ],
                correctAnswer: 1,
                explanation: "Variabel bebas adalah faktor yang sengaja diubah dalam percobaan. Dalam percobaan ini, frekuensi penyiraman (setiap hari, dua hari sekali, tidak disiram) adalah variabel bebas yang sengaja diubah untuk melihat pengaruhnya terhadap pertumbuhan tanaman."
            },
            {
                question: "Perhatikan daur hidup kupu-kupu berikut: Telur  Ulat  Kepompong  Kupu-kupu. Proses perubahan bentuk tubuh yang dialami kupu-kupu selama daur hidupnya disebut...",
                options: [
                    "A. Metagenesis",
                    "B. Metamorfosis sempurna",
                    "C. Metamorfosis tidak sempurna",
                    "D. Regenerasi",
                    "E. Fotosintesis"
                ],
                correctAnswer: 1,
                explanation: "Metamorfosis sempurna adalah proses perkembangan hewan yang melalui empat tahap berbeda: telur, larva (ulat), pupa (kepompong), dan imago (dewasa). Kupu-kupu mengalami metamorfosis sempurna dengan perubahan bentuk yang sangat berbeda di setiap tahapnya."
            },
            {
                question: "Perhatikan tabel berikut tentang sifat-sifat benda:\n1) Volume tetap\n2) Bentuk berubah sesuai wadah\n3) Susunan partikel sangat rapat\n4) Gerakan partikel bebas\nManakah yang merupakan sifat zat cair?",
                options: [
                    "A. 1 dan 2",
                    "B. 1 dan 3",
                    "C. 2 dan 3",
                    "D. 2 dan 4",
                    "E. 3 dan 4"
                ],
                correctAnswer: 2,
                explanation: "Sifat zat cair: 1) Volume tetap, 2) Bentuk berubah sesuai wadah, 3) Susunan partikel kurang rapat dibanding padat tetapi lebih rapat dibanding gas, 4) Gerakan partikel lebih bebas daripada zat padat tetapi lebih terbatas daripada gas."
            },
            {
                question: "Dalam suatu percobaan tentang konduktor dan isolator panas, seorang siswa memanaskan berbagai benda selama 1 menit kemudian mengukur suhunya. Hasilnya menunjukkan logam tembaga mengalami kenaikan suhu paling tinggi, sedangkan kayu hampir tidak mengalami kenaikan suhu. Kesimpulan yang tepat dari percobaan ini adalah...",
                options: [
                    "A. Tembaga adalah isolator panas yang baik",
                    "B. Kayu adalah konduktor panas yang baik",
                    "C. Tembaga adalah konduktor panas yang baik",
                    "D. Kayu dan tembaga sama-sama isolator",
                    "E. Semua logam adalah isolator panas"
                ],
                correctAnswer: 2,
                explanation: "Benda yang mudah menghantarkan panas (mengalami kenaikan suhu cepat) disebut konduktor panas yang baik (seperti tembaga). Benda yang sulit menghantarkan panas disebut isolator panas (seperti kayu). Hasil percobaan menunjukkan tembaga adalah konduktor panas yang baik."
            },
            {
                question: "Perhatikan gambar sistem tata surya! Planet yang memiliki ciri-ciri: 1) Dikenal sebagai planet merah, 2) Memiliki dua satelit alami (Phobos dan Deimos), 3) Memiliki gunung tertinggi di tata surya (Olympus Mons), adalah planet...",
                options: [
                    "A. Merkurius",
                    "B. Venus",
                    "C. Bumi",
                    "D. Mars",
                    "E. Jupiter"
                ],
                correctAnswer: 3,
                explanation: "Mars dikenal sebagai planet merah karena permukaannya yang berwarna kemerahan akibat kandungan besi oksida. Mars memiliki dua satelit kecil (Phobos dan Deimos) dan gunung Olympus Mons yang merupakan gunung berapi tertinggi di tata surya dengan tinggi sekitar 21 km."
            }
        ],
        'IPS': [
            {
                question: "Perhatikan peta provinsi di Indonesia! Provinsi yang terletak paling timur dan berbatasan langsung dengan Papua Nugini adalah...",
                options: [
                    "A. Papua Barat",
                    "B. Maluku",
                    "C. Nusa Tenggara Timur",
                    "D. Papua",
                    "E. Kalimantan Utara"
                ],
                correctAnswer: 3,
                explanation: "Provinsi Papua merupakan provinsi paling timur di Indonesia yang berbatasan langsung dengan negara Papua Nugini. Batas darat Indonesia-Papua Nugini sepanjang 820 km membentang dari pantai utara hingga pantai selatan Pulau Papua."
            },
            {
                question: "Perhatikan gambar candi berikut yang memiliki ciri khas stupa dan termasuk warisan dunia UNESCO! Candi yang dimaksud adalah...",
                options: [
                    "A. Candi Prambanan",
                    "B. Candi Borobudur",
                    "C. Candi Mendut",
                    "D. Candi Sewu",
                    "E. Candi Kalasan"
                ],
                correctAnswer: 1,
                explanation: "Candi Borobudur adalah candi Buddha terbesar di dunia yang dibangun pada abad ke-9 pada masa pemerintahan wangsa Syailendra. Candi ini terkenal dengan stupa-stupanya dan menjadi salah satu warisan dunia UNESCO sejak 1991."
            },
            {
                question: "Perhatikan tabel kegiatan ekonomi berikut:\n1) Nelayan menangkap ikan di laut\n2) Petani menanam padi di sawah\n3) Pabrik mengolah kain menjadi pakaian\n4) Toko menjual barang kebutuhan sehari-hari\nManakah yang termasuk kegiatan produksi?",
                options: [
                    "A. 1 dan 2",
                    "B. 1, 2, dan 3",
                    "C. 2 dan 3",
                    "D. 3 dan 4",
                    "E. Semua benar"
                ],
                correctAnswer: 1,
                explanation: "Kegiatan produksi adalah kegiatan menambah nilai guna suatu barang atau menghasilkan barang/jasa. Nelayan menangkap ikan, petani menanam padi, dan pabrik mengolah kain termasuk kegiatan produksi. Toko menjual barang termasuk distribusi, bukan produksi."
            },
            {
                question: "Perhatikan gambar uang kertas Indonesia! Nilai uang yang memiliki gambar pahlawan Cut Nyak Dhien adalah pecahan...",
                options: [
                    "A. Rp1.000",
                    "B. Rp5.000",
                    "C. Rp10.000",
                    "D. Rp20.000",
                    "E. Rp50.000"
                ],
                correctAnswer: 2,
                explanation: "Cut Nyak Dhien adalah pahlawan nasional dari Aceh yang memimpin perlawanan terhadap Belanda dalam Perang Aceh. Gambarnya menghiasi uang kertas pecahan Rp10.000 emisi tahun 2016."
            },
            {
                question: "Perhatikan peta persebaran flora dan fauna di Indonesia! Garis yang memisahkan wilayah fauna Indonesia Barat dan Indonesia Tengah adalah garis...",
                options: [
                    "A. Weber",
                    "B. Wallace",
                    "C. Khatulistiwa",
                    "D. Lintang",
                    "E. Bujur"
                ],
                correctAnswer: 0,
                explanation: "Garis Weber adalah garis imajiner yang memisahkan wilayah fauna Indonesia Tengah (Peralihan) dengan Indonesia Timur. Garis Wallace memisahkan Indonesia Barat dengan Indonesia Tengah. Kedua garis ini menunjukkan perbedaan jenis fauna di Indonesia."
            },
            {
                question: "Perhatikan gambar tokoh proklamator Indonesia! Tokoh yang mendampingi Soekarno dalam membacakan teks proklamasi pada 17 Agustus 1945 adalah...",
                options: [
                    "A. Mohammad Hatta",
                    "B. Sutan Sjahrir",
                    "C. Tan Malaka",
                    "D. Gatot Subroto",
                    "E. Ki Hajar Dewantara"
                ],
                correctAnswer: 0,
                explanation: "Mohammad Hatta adalah tokoh proklamator yang mendampingi Soekarno dalam membacakan teks proklamasi kemerdekaan Indonesia pada 17 Agustus 1945 di Jalan Pegangsaan Timur 56, Jakarta. Beliau juga merupakan Wakil Presiden pertama Indonesia."
            },
            {
                question: "Perhatikan gambar rumah adat Indonesia! Rumah adat yang memiliki ciri khas atap berbentuk tanduk kerbau dan berasal dari Sumatera Barat adalah...",
                options: [
                    "A. Rumah Joglo",
                    "B. Rumah Gadang",
                    "C. Rumah Limas",
                    "D. Rumah Tongkonan",
                    "E. Rumah Honai"
                ],
                correctAnswer: 1,
                explanation: "Rumah Gadang adalah rumah tradisional Minangkabau, Sumatera Barat, dengan ciri khas atap melengkung seperti tanduk kerbau dan struktur gonjong. Rumah ini mencerminkan sistem matrilineal masyarakat Minang dan tahan gempa."
            },
            {
                question: "Perhatikan denah lokasi berikut! Jika sekolah terletak di sebelah timur rumah, dan pasar terletak di sebelah utara sekolah, maka posisi pasar terhadap rumah adalah...",
                options: [
                    "A. Timur laut",
                    "B. Tenggara",
                    "C. Barat daya",
                    "D. Barat laut",
                    "E. Timur laut"
                ],
                correctAnswer: 0,
                explanation: "Jika sekolah di timur rumah, dan pasar di utara sekolah, maka pasar berada di arah timur laut dari rumah. Untuk menentukan arah, buatlah diagram sederhana dengan rumah sebagai titik pusat."
            },
            {
                question: "Perhatikan gambar lambang negara Indonesia! Sila yang diwakili oleh gambar rantai pada lambang Garuda Pancasila adalah sila...",
                options: [
                    "A. Ketuhanan Yang Maha Esa",
                    "B. Kemanusiaan yang adil dan beradab",
                    "C. Persatuan Indonesia",
                    "D. Kerakyatan yang dipimpin oleh hikmat kebijaksanaan dalam permusyawaratan/perwakilan",
                    "E. Keadilan sosial bagi seluruh rakyat Indonesia"
                ],
                correctAnswer: 1,
                explanation: "Pada lambang Garuda Pancasila, rantai emas yang terdiri dari mata rantai persegi dan lingkaran yang saling berkait mewakili sila kedua: Kemanusiaan yang Adil dan Beradab. Rantai melambangkan hubungan antarmanusia yang saling membantu."
            },
            {
                question: "Perhatikan tabel hasil bumi Indonesia berikut:\n1) Kelapa sawit\n2) Teh\n3) Kopi\n4) Tembakau\nKomoditas yang menjadi andalan ekspor Indonesia dari sektor perkebunan adalah...",
                options: [
                    "A. 1 dan 2",
                    "B. 1, 2, dan 3",
                    "C. 2 dan 3",
                    "D. 3 dan 4",
                    "E. Semua benar"
                ],
                correctAnswer: 1,
                explanation: "Indonesia merupakan salah satu produsen dan eksportir utama kelapa sawit, teh, dan kopi dunia. Kelapa sawit adalah komoditas ekspor terbesar Indonesia dari sektor perkebunan, diikuti oleh kopi dan teh yang memiliki pasar internasional yang luas."
            }
        ]
    },
    'SMP': {
        'IPA': [
            {
                question: "Perhatikan gambar sel tumbuhan! Organel sel yang berfungsi sebagai tempat berlangsungnya fotosintesis dan hanya dimiliki oleh sel tumbuhan adalah...",
                options: [
                    "A. Mitokondria",
                    "B. Kloroplas",
                    "C. Nukleus",
                    "D. Ribosom",
                    "E. Badan Golgi"
                ],
                correctAnswer: 1,
                explanation: "Kloroplas adalah organel sel tumbuhan yang mengandung klorofil, pigmen hijau yang menangkap energi cahaya untuk fotosintesis. Proses ini mengubah karbon dioksida dan air menjadi glukosa dan oksigen. Kloroplas tidak dimiliki oleh sel hewan."
            },
            {
                question: "Perhatikan tabel perubahan materi berikut:\n1) Besi berkarat\n2) Es mencair\n3) Kayu terbakar\n4) Gula larut dalam air\nManakah yang termasuk perubahan kimia?",
                options: [
                    "A. 1 dan 2",
                    "B. 1 dan 3",
                    "C. 2 dan 3",
                    "D. 2 dan 4",
                    "E. 3 dan 4"
                ],
                correctAnswer: 1,
                explanation: "Perubahan kimia ditandai dengan terbentuknya zat baru yang sifatnya berbeda dari zat semula. Besi berkarat (menjadi besi oksida) dan kayu terbakar (menjadi arang/karbon) adalah perubahan kimia. Es mencair dan gula larut adalah perubahan fisika karena tidak menghasilkan zat baru."
            },
            {
                question: "Perhatikan gambar sistem pencernaan manusia! Enzim yang dihasilkan oleh organ nomor 3 (lambung) dan berfungsi untuk mengubah protein menjadi pepton adalah...",
                options: [
                    "A. Amilase",
                    "B. Pepsin",
                    "C. Lipase",
                    "D. Tripsin",
                    "E. Sukrase"
                ],
                correctAnswer: 1,
                explanation: "Lambung menghasilkan enzim pepsin yang berfungsi mengubah protein menjadi pepton. Pepsin bekerja optimal dalam suasana asam (pH 1.5-2) yang disediakan oleh asam klorida (HCl) yang juga dihasilkan lambung."
            },
            {
                question: "Perhatikan gambar percobaan fotosintesis! Tujuan penggunaan aluminium foil untuk membungkus sebagian daun sebelum percobaan adalah untuk...",
                options: [
                    "A. Membunuh sel-sel daun",
                    "B. Mencegah penguapan air",
                    "C. Menghalangi cahaya matahari",
                    "D. Mempercepat proses fotosintesis",
                    "E. Melindungi dari serangga"
                ],
                correctAnswer: 2,
                explanation: "Dalam percobaan fotosintesis, bagian daun yang dibungkus aluminium foil tidak mendapat cahaya matahari sehingga tidak dapat berfotosintesis. Setelah percobaan, daun diuji dengan yodium/lugol untuk membuktikan bahwa hanya bagian yang terkena cahaya menghasilkan amilum (menjadi biru kehitaman)."
            },
            {
                question: "Perhatikan gambar rangkaian listrik berikut! Jika saklar 1 ditutup dan saklar 2 dibuka, maka lampu yang akan menyala adalah...",
                options: [
                    "A. Hanya lampu A",
                    "B. Hanya lampu B",
                    "C. Lampu A dan B",
                    "D. Lampu B dan C",
                    "E. Tidak ada lampu yang menyala"
                ],
                correctAnswer: 0,
                explanation: "Dalam rangkaian paralel, setiap cabang bekerja independen. Jika saklar 1 ditutup (ON) dan saklar 2 dibuka (OFF), hanya lampu A yang mendapat aliran listrik dan menyala. Lampu B tidak menyala karena saklar 2 terbuka, meskipun secara fisik terhubung."
            },
            {
                question: "Perhatikan gambar sistem pernapasan manusia! Proses pertukaran oksigen dan karbon dioksida antara darah dan udara pernapasan terjadi di bagian yang ditunjukkan oleh nomor...",
                options: [
                    "A. 1 (rongga hidung)",
                    "B. 2 (tenggorokan)",
                    "C. 3 (bronkus)",
                    "D. 4 (bronkiolus)",
                    "E. 5 (alveolus)"
                ],
                correctAnswer: 4,
                explanation: "Alveolus adalah gelembung-gelembung kecil di ujung saluran pernapasan yang dikelilingi kapiler darah. Di sini terjadi difusi oksigen dari udara ke darah dan karbon dioksida dari darah ke udara karena perbedaan tekanan parsial gas."
            },
            {
                question: "Perhatikan tabel sifat zat berikut:\n1) Volume tetap\n2) Bentuk berubah sesuai wadah\n3) Susunan partikel sangat rapat\n4) Gerakan partikel sangat bebas\nManakah yang merupakan sifat gas?",
                options: [
                    "A. 1 dan 2",
                    "B. 1 dan 3",
                    "C. 2 dan 3",
                    "D. 2 dan 4",
                    "E. 3 dan 4"
                ],
                correctAnswer: 3,
                explanation: "Sifat gas: 1) Volume berubah mengisi wadah, 2) Bentuk berubah mengikuti wadah, 3) Susunan partikel sangat renggang, 4) Gerakan partikel sangat bebas dan cepat. Gas tidak memiliki volume dan bentuk tetap karena gaya tarik antarpartikel sangat lemah."
            },
            {
                question: "Perhatikan gambar pembiasan cahaya! Jika cahaya merambat dari udara ke air (indeks bias air lebih besar), maka cahaya akan...",
                options: [
                    "A. Membias menjauhi garis normal",
                    "B. Membias mendekati garis normal",
                    "C. Tidak mengalami pembiasan",
                    "D. Dipantulkan sempurna",
                    "E. Diserap seluruhnya"
                ],
                correctAnswer: 1,
                explanation: "Ketika cahaya merambat dari medium kurang rapat (udara) ke medium lebih rapat (air), cahaya akan membias mendekati garis normal (garis tegak lurus bidang batas). Ini terjadi karena kecepatan cahaya berkurang saat memasuki medium lebih rapat."
            },
            {
                question: "Perhatikan gambar sistem reproduksi wanita! Tempat terjadinya fertilisasi (pembuahan sel telur oleh sperma) ditunjukkan oleh nomor...",
                options: [
                    "A. 1 (ovarium)",
                    "B. 2 (tuba falopi)",
                    "C. 3 (uterus)",
                    "D. 4 (serviks)",
                    "E. 5 (vagina)"
                ],
                correctAnswer: 1,
                explanation: "Fertilisasi terjadi di tuba falopi (oviduk) bagian ampula, yaitu bagian yang melebar dekat ovarium. Setelah fertilisasi, zigot akan bergerak ke uterus untuk implantasi. Ovarium adalah tempat produksi sel telur, uterus tempat perkembangan janin."
            },
            {
                question: "Perhatikan gambar percobaan elektromagnet! Faktor yang mempengaruhi kekuatan elektromagnet adalah: 1) Jumlah lilitan kawat, 2) Kuat arus listrik, 3) Jenis inti besi, 4) Ukuran baterai. Manakah yang benar?",
                options: [
                    "A. 1 dan 2",
                    "B. 1, 2, dan 3",
                    "C. 2 dan 3",
                    "D. 3 dan 4",
                    "E. Semua benar"
                ],
                correctAnswer: 1,
                explanation: "Kekuatan elektromagnet dipengaruhi oleh: 1) Jumlah lilitan (semakin banyak semakin kuat), 2) Kuat arus (semakin besar arus semakin kuat), 3) Jenis inti besi (besi lunak lebih baik daripada baja). Ukuran baterai tidak langsung mempengaruhi selama tegangan tetap."
            }
        ],
        'IPS': [
            {
                question: "Perhatikan peta persebaran kerajaan Hindu-Buddha di Indonesia! Kerajaan yang mencapai puncak kejayaan pada masa pemerintahan Raja Hayam Wuruk dengan patih Gajah Mada adalah...",
                options: [
                    "A. Sriwijaya",
                    "B. Majapahit",
                    "C. Kutai",
                    "D. Tarumanegara",
                    "E. Singasari"
                ],
                correctAnswer: 1,
                explanation: "Kerajaan Majapahit mencapai puncak kejayaan pada abad ke-14 di bawah Raja Hayam Wuruk (1350-1389) dengan patih Gajah Mada yang mengucapkan Sumpah Palapa untuk menyatukan Nusantara. Majapahit menguasai wilayah yang luas meliputi Sumatra, Jawa, Borneo, hingga sebagian Filipina."
            },
            {
                question: "Perhatikan tabel kegiatan ekonomi berikut:\n1) Petani menanam padi\n2) Pabrik mengolah kelapa sawit menjadi minyak goreng\n3) Supermarket menjual kebutuhan pokok\n4) Konsumen membeli beras untuk kebutuhan rumah tangga\nManakah yang termasuk kegiatan distribusi?",
                options: [
                    "A. 1",
                    "B. 2",
                    "C. 3",
                    "D. 4",
                    "E. 1 dan 2"
                ],
                correctAnswer: 2,
                explanation: "Kegiatan distribusi adalah kegiatan menyalurkan barang dari produsen ke konsumen. Supermarket menjual kebutuhan pokok termasuk distribusi. Petani menanam padi (produksi), pabrik mengolah sawit (produksi), konsumen membeli beras (konsumsi)."
            },
            {
                question: "Perhatikan gambar candi berikut yang memiliki ciri khas relief Ramayana dan termasuk kompleks candi Hindu terbesar di Indonesia! Candi yang dimaksud adalah...",
                options: [
                    "A. Candi Borobudur",
                    "B. Candi Prambanan",
                    "C. Candi Mendut",
                    "D. Candi Sewu",
                    "E. Candi Kalasan"
                ],
                correctAnswer: 1,
                explanation: "Candi Prambanan adalah kompleks candi Hindu terbesar di Indonesia yang dibangun pada abad ke-9. Candi ini dipersembahkan untuk Trimurti (Brahma, Wisnu, Siwa) dan memiliki relief cerita Ramayana yang mengelilingi candi utama."
            },
            {
                question: "Perhatikan peta wilayah ASEAN! Negara anggota ASEAN yang berbentuk kepulauan dan tidak memiliki daratan yang bersambung dengan negara lain adalah...",
                options: [
                    "A. Thailand",
                    "B. Filipina",
                    "C. Vietnam",
                    "D. Myanmar",
                    "E. Kamboja"
                ],
                correctAnswer: 1,
                explanation: "Filipina adalah negara kepulauan di ASEAN yang terdiri dari 7.641 pulau dan tidak memiliki daratan yang bersambung dengan negara lain. Negara ASEAN lainnya seperti Thailand, Myanmar, Vietnam, dan Kamboja berada di daratan Asia Tenggara."
            },
            {
                question: "Perhatikan tabel berikut tentang jenis-jenis pajak:\n1) Pajak Penghasilan (PPh)\n2) Pajak Pertambahan Nilai (PPN)\n3) Pajak Bumi dan Bangunan (PBB)\n4) Pajak Kendaraan Bermotor\nManakah yang termasuk pajak pusat?",
                options: [
                    "A. 1 dan 2",
                    "B. 1, 2, dan 3",
                    "C. 2 dan 3",
                    "D. 3 dan 4",
                    "E. Semua benar"
                ],
                correctAnswer: 0,
                explanation: "Pajak pusat adalah pajak yang dikelola pemerintah pusat (Direktorat Jenderal Pajak) meliputi: PPh, PPN, PPnBM, PBB (sektor tertentu), Bea Meterai, dan pajak lainnya. PBB (umum) dan Pajak Kendaraan Bermotor sudah menjadi pajak daerah."
            },
            {
                question: "Perhatikan gambar tokoh proklamator kemerdekaan Indonesia! Tokoh yang merumuskan Pancasila dan dikenal sebagai 'Bapak Proklamator' bersama Mohammad Hatta adalah...",
                options: [
                    "A. Soekarno",
                    "B. Sutan Sjahrir",
                    "C. Tan Malaka",
                    "D. Gatot Subroto",
                    "E. Ki Hajar Dewantara"
                ],
                correctAnswer: 0,
                explanation: "Soekarno adalah tokoh proklamator kemerdekaan Indonesia yang membacakan teks proklamasi pada 17 Agustus 1945 bersama Mohammad Hatta. Beliau juga yang pertama kali mengemukakan konsep Pancasila pada sidang BPUPKI 1 Juni 1945."
            },
            {
                question: "Perhatikan peta persebaran penduduk Indonesia! Pulau yang memiliki kepadatan penduduk tertinggi dibandingkan luas wilayahnya adalah...",
                options: [
                    "A. Sumatra",
                    "B. Jawa",
                    "C. Kalimantan",
                    "D. Sulawesi",
                    "E. Papua"
                ],
                correctAnswer: 1,
                explanation: "Pulau Jawa memiliki kepadatan penduduk tertinggi di Indonesia (sekitar 1.171 jiwa/km, 2020), meskipun luasnya hanya 7% dari total wilayah Indonesia, tetapi dihuni oleh sekitar 56% penduduk Indonesia. Ketimpangan ini disebabkan oleh kesuburan tanah dan pusat pemerintahan berada di Jawa."
            },
            {
                question: "Perhatikan gambar uang kertas Indonesia! Pecahan uang yang memiliki gambar pahlawan I Gusti Ngurah Rai adalah...",
                options: [
                    "A. Rp1.000",
                    "B. Rp5.000",
                    "C. Rp10.000",
                    "D. Rp50.000",
                    "E. Rp100.000"
                ],
                correctAnswer: 3,
                explanation: "I Gusti Ngurah Rai adalah pahlawan nasional dari Bali yang memimpin Puputan Margarana melawan Belanda. Gambarnya menghiasi uang kertas pecahan Rp50.000 emisi tahun 2016. Beliau gugur dalam pertempuran di Margarana, Bali pada 20 November 1946."
            },
            {
                question: "Perhatikan tabel lembaga negara berikut:\n1) Presiden\n2) DPR\n3) Mahkamah Agung\n4) BPK\nLembaga yang memiliki fungsi legislatif adalah...",
                options: [
                    "A. 1",
                    "B. 2",
                    "C. 3",
                    "D. 4",
                    "E. 1 dan 2"
                ],
                correctAnswer: 1,
                explanation: "DPR (Dewan Perwakilan Rakyat) adalah lembaga legislatif yang bertugas membuat undang-undang. Presiden termasuk eksekutif, MA dan MK termasuk yudikatif, BPK termasuk lembaga audit. Fungsi legislatif di Indonesia juga melibatkan DPD dan Presiden dalam pembentukan UU."
            },
            {
                question: "Perhatikan gambar benua dan samudra dunia! Samudra yang terletak di sebelah barat benua Amerika dan sebelah timur benua Asia adalah...",
                options: [
                    "A. Samudra Atlantik",
                    "B. Samudra Pasifik",
                    "C. Samudra Hindia",
                    "D. Samudra Arktik",
                    "E. Samudra Antarktika"
                ],
                correctAnswer: 1,
                explanation: "Samudra Pasifik adalah samudra terbesar di dunia yang membentang dari sebelah barat Amerika hingga timur Asia. Samudra ini mencakup sekitar 1/3 permukaan bumi dan memiliki Palung Mariana sebagai titik terdalam di bumi (10.984 meter)."
            }
        ]
    },
    'SMA/SMK': {
        'IPA': [
            {
                question: "Perhatikan reaksi kimia berikut: CHO + 6O  6CO + 6HO + Energi. Reaksi ini terjadi di organel sel yang memiliki ciri-ciri: 1) Memiliki membran dalam yang berlipat-lipat (krista), 2) Mengandung enzim untuk siklus Krebs, 3) Dikenal sebagai 'powerhouse of the cell'. Organel yang dimaksud adalah...",
                options: [
                    "A. Nukleus",
                    "B. Ribosom",
                    "C. Lisosom",
                    "D. Mitokondria",
                    "E. Retikulum Endoplasma"
                ],
                correctAnswer: 3,
                explanation: "Reaksi tersebut adalah respirasi aerob yang terjadi di mitokondria. Mitokondria memiliki membran dalam berlipat (krista) yang memperluas permukaan untuk reaksi rantai transpor elektron. Matriks mitokondria mengandung enzim untuk siklus Krebs dan disebut 'powerhouse' karena menghasilkan ATP."
            },
            {
                question: "Perhatikan grafik hubungan antara suhu dengan kelarutan beberapa garam! Berdasarkan grafik, kelarutan garam KNO yang paling tepat dinyatakan dalam persamaan...",
                options: [
                    "A. Kelarutan tidak dipengaruhi suhu",
                    "B. Kelarutan berkurang seiring kenaikan suhu",
                    "C. Kelarutan bertambah secara linear dengan suhu",
                    "D. Kelarutan bertambah secara eksponensial dengan suhu",
                    "E. Kelarutan bertambah seiring kenaikan suhu tetapi tidak linear"
                ],
                correctAnswer: 4,
                explanation: "Kelarutan KNO meningkat dengan kenaikan suhu tetapi tidak linear. Pada suhu rendah, kenaikan kelarutan relatif kecil, sedangkan pada suhu tinggi, kenaikan kelarutan lebih signifikan. Ini karena proses pelarutan KNO bersifat endoterm (menyerap panas)."
            },
            {
                question: "Perhatikan gambar percobaan hukum Ohm! Jika hambatan kawat nikrom diperbesar dua kali semula sedangkan tegangan dijaga tetap, maka kuat arus yang mengalir akan...",
                options: [
                    "A. Tetap",
                    "B. Menjadi dua kali semula",
                    "C. Menjadi setengah kali semula",
                    "D. Menjadi seperempat kali semula",
                    "E. Menjadi empat kali semula"
                ],
                correctAnswer: 2,
                explanation: "Berdasarkan hukum Ohm V = I  R, jika V konstan dan R menjadi 2 kali semula, maka I akan menjadi 1/2 kali semula. Hubungan antara I dan R berbanding terbalik ketika tegangan tetap."
            },
            {
                question: "Perhatikan gambar sistem reproduksi pria! Organ yang berfungsi menghasilkan sperma dan hormon testosteron ditunjukkan oleh nomor...",
                options: [
                    "A. 1 (vesikula seminalis)",
                    "B. 2 (prostat)",
                    "C. 3 (epididimis)",
                    "D. 4 (vas deferens)",
                    "E. 5 (testis)"
                ],
                correctAnswer: 4,
                explanation: "Testis (nomor 5) adalah organ reproduksi pria yang berfungsi menghasilkan sperma melalui proses spermatogenesis di tubulus seminiferus, dan menghasilkan hormon testosteron dari sel Leydig. Testosteron berperan dalam perkembangan ciri kelamin sekunder pria."
            },
            {
                question: "Perhatikan tabel sifat koloid berikut:\n1) Efek Tyndall\n2) Gerak Brown\n3) Koagulasi\n4) Adsorpsi\nManakah yang merupakan sifat-sifat koloid?",
                options: [
                    "A. 1 dan 2",
                    "B. 1, 2, dan 3",
                    "C. 2 dan 3",
                    "D. 3 dan 4",
                    "E. Semua benar"
                ],
                correctAnswer: 4,
                explanation: "Semua pernyataan adalah sifat koloid: 1) Efek Tyndall - penghamburan cahaya oleh partikel koloid, 2) Gerak Brown - gerak acak partikel koloid, 3) Koagulasi - penggumpalan partikel koloid, 4) Adsorpsi - penyerapan partikel pada permukaan koloid."
            },
            {
                question: "Perhatikan gambar percobaan fotosintesis! Jika tanaman air Hydrilla sp. ditempatkan dalam corong terbalik yang berisi air dan dipapar cahaya, gas yang akan terkumpul di tabung reaksi adalah...",
                options: [
                    "A. Karbon dioksida",
                    "B. Oksigen",
                    "C. Nitrogen",
                    "D. Hidrogen",
                    "E. Metana"
                ],
                correctAnswer: 1,
                explanation: "Pada fotosintesis, Hydrilla sp. akan menghasilkan oksigen sebagai produk samping yang dapat terlihat sebagai gelembung gas. Gas ini dapat diuji dengan membakar bara api yang akan menyala lebih terang karena oksigen mendukung pembakaran."
            },
            {
                question: "Perhatikan gambar gelombang transversal berikut! Jika jarak AB = 30 cm dan waktu tempuh dari A ke B = 0,5 sekon, maka besar frekuensi gelombang adalah...",
                options: [
                    "A. 0,5 Hz",
                    "B. 1 Hz",
                    "C. 1,5 Hz",
                    "D. 2 Hz",
                    "E. 2,5 Hz"
                ],
                correctAnswer: 1,
                explanation: "Jarak AB = 30 cm = 1,5   = 20 cm. Waktu tempuh A ke B = 0,5 s = 1,5T  T = 1/3 s. Frekuensi f = 1/T = 3 Hz. Namun jika AB adalah 1 (30 cm) dan waktu 0,5 s adalah 1T, maka f = 1/0,5 = 2 Hz. (Asumsi soal mungkin berbeda)"
            },
            {
                question: "Perhatikan reaksi redoks berikut: 2Al + 3Cu  2Al + 3Cu. Pernyataan yang benar tentang reaksi ini adalah...",
                options: [
                    "A. Al mengalami reduksi",
                    "B. Cu bersifat oksidator",
                    "C. Al bertindak sebagai oksidator",
                    "D. Cu mengalami oksidasi",
                    "E. Tidak terjadi transfer elektron"
                ],
                correctAnswer: 1,
                explanation: "Dalam reaksi ini: Al  Al + 3e (oksidasi, Al sebagai reduktor), Cu + 2e  Cu (reduksi, Cu sebagai oksidator). Oksidator adalah zat yang mengoksidasi zat lain dengan cara menerima elektron (Cu dalam hal ini)."
            },
            {
                question: "Perhatikan gambar percobaan hukum Mendel! Persilangan antara kacang ercis berbiji bulat (BB) dengan biji keriput (bb) menghasilkan F1 semua bulat. Jika F1 disilangkan sesamanya, perbandingan fenotip F2 adalah...",
                options: [
                    "A. Bulat semua",
                    "B. Keriput semua",
                    "C. Bulat : Keriput = 1:1",
                    "D. Bulat : Keriput = 3:1",
                    "E. Bulat : Keriput = 9:3:3:1"
                ],
                correctAnswer: 3,
                explanation: "Ini mengikuti hukum segregasi Mendel. Parental: BB x bb  F1: Bb (bulat). F1 x F1: Bb x Bb  F2: 1 BB : 2 Bb : 1 bb (fenotip 3 bulat : 1 keriput). Sifat bulat dominan terhadap keriput."
            },
            {
                question: "Perhatikan gambar sistem peredaran darah manusia! Pembuluh darah yang membawa darah kaya oksigen dari paru-paru ke jantung adalah...",
                options: [
                    "A. Vena pulmonalis",
                    "B. Arteri pulmonalis",
                    "C. Vena kava",
                    "D. Aorta",
                    "E. Arteri koronaria"
                ],
                correctAnswer: 0,
                explanation: "Vena pulmonalis adalah pembuluh darah yang membawa darah kaya oksigen dari paru-paru ke atrium kiri jantung. Ini satu-satunya vena yang membawa darah bersih. Arteri pulmonalis membawa darah kotor dari jantung ke paru-paru."
            }
        ],
        'IPS': [
            {
                question: "Perhatikan peta wilayah kekuasaan Majapahit! Faktor utama yang mendorong Majapahit menjadi kerajaan besar pada abad ke-14 adalah...",
                options: [
                    "A. Letaknya yang strategis di jalur perdagangan rempah",
                    "B. Kekuatan militer yang tidak tertandingi",
                    "C. Sistem pemerintahan yang terpusat dan efektif",
                    "D. Kepemimpinan Hayam Wuruk dan Gajah Mada",
                    "E. Adanya persatuan antar kerajaan melalui Sumpah Palapa"
                ],
                correctAnswer: 3,
                explanation: "Puncak kejayaan Majapahit dicapai melalui kombinasi kepemimpinan Raja Hayam Wuruk yang visioner dan Patih Gajah Mada yang mampu menerapkan Sumpah Palapa untuk menyatukan Nusantara. Faktor lain seperti letak strategis dan sistem pemerintahan juga penting, tetapi kepemimpinan menjadi kunci utama."
            },
            {
                question: "Perhatikan tabel indikator ekonomi berikut:\n1) Tingkat pengangguran\n2) Indeks Pembangunan Manusia (IPM)\n3) Pendapatan per kapita\n4) Tingkat inflasi\nIndikator yang digunakan untuk mengukur keberhasilan pembangunan ekonomi suatu negara adalah...",
                options: [
                    "A. 1 dan 2",
                    "B. 1, 2, dan 3",
                    "C. 2 dan 3",
                    "D. 3 dan 4",
                    "E. Semua benar"
                ],
                correctAnswer: 4,
                explanation: "Keberhasilan pembangunan ekonomi diukur dengan berbagai indikator: 1) Tingkat pengangguran (ketenagakerjaan), 2) IPM (kesehatan, pendidikan, pendapatan), 3) Pendapatan per kapita (kesejahteraan), 4) Tingkat inflasi (stabilitas ekonomi). Semuanya memberikan gambaran komprehensif."
            },
            {
                question: "Perhatikan grafik pertumbuhan penduduk Indonesia! Masalah kependudukan yang paling krusial dihadapi Indonesia berdasarkan grafik tersebut adalah...",
                options: [
                    "A. Ledakan penduduk usia produktif",
                    "B. Ketimpangan persebaran penduduk",
                    "C. Penurunan angka kelahiran",
                    "D. Peningkatan angka kematian bayi",
                    "E. Migrasi penduduk ke luar negeri"
                ],
                correctAnswer: 0,
                explanation: "Indonesia mengalami bonus demografi dengan proporsi penduduk usia produktif (15-64 tahun) yang besar. Ini bisa menjadi peluang jika disertai lapangan kerja memadai, tetapi menjadi masalah jika tidak diimbangi kualitas SDM dan kesempatan kerja, berpotensi meningkatkan pengangguran dan ketimpangan."
            },
            {
                question: "Perhatikan gambar candi Borobudur! Nilai-nilai yang dapat dipelajari dari candi Borobudur sebagai warisan budaya dunia adalah: 1) Toleransi beragama, 2) Kemajuan teknologi arsitektur, 3) Seni dan budaya yang tinggi, 4) Sistem pemerintahan yang teratur. Manakah yang benar?",
                options: [
                    "A. 1 dan 2",
                    "B. 1, 2, dan 3",
                    "C. 2 dan 3",
                    "D. 3 dan 4",
                    "E. Semua benar"
                ],
                correctAnswer: 1,
                explanation: "Borobudur mencerminkan: 1) Toleransi antara Hindu-Buddha, 2) Teknologi arsitektur canggih dengan sistem drainase dan struktur batu tanpa semen, 3) Seni relief yang detail dan filosofis. Sistem pemerintahan tidak langsung tercermin dalam candi."
            },
            {
                question: "Perhatikan peta sebaran flora dan fauna Indonesia! Garis Wallace dan Weber penting dalam biogeografi karena...",
                options: [
                    "A. Menunjukkan batas wilayah administrasi",
                    "B. Membedakan zona waktu di Indonesia",
                    "C. Menjelaskan perbedaan jenis flora dan fauna",
                    "D. Menandai pusat keanekaragaman hayati",
                    "E. Menunjukkan jalur migrasi hewan purba"
                ],
                correctAnswer: 2,
                explanation: "Garis Wallace (memisahkan zona Asia dan Peralihan) dan Weber (memisahkan zona Peralihan dan Australia) menjelaskan perbedaan jenis flora/fauna di Indonesia akibat sejarah geologi dan iklim. Fauna barat mirip Asia, timur mirip Australia, tengah campuran."
            },
            {
                question: "Perhatikan tabel kebijakan ekonomi berikut:\n1) Menaikkan suku bunga\n2) Meningkatkan belanja pemerintah\n3) Menurunkan pajak penghasilan\n4) Membatasi jumlah uang beredar\nKebijakan yang termasuk fiskal ekspansif untuk mengatasi resesi adalah...",
                options: [
                    "A. 1 dan 2",
                    "B. 1 dan 3",
                    "C. 2 dan 3",
                    "D. 3 dan 4",
                    "E. Semua benar"
                ],
                correctAnswer: 2,
                explanation: "Kebijakan fiskal ekspansif (stimulus) untuk mengatasi resesi: 2) Meningkatkan belanja pemerintah untuk dorong permintaan, 3) Menurunkan pajak untuk tingkatkan daya beli. Kebijakan 1 dan 4 adalah moneter kontraktif, bukan untuk hadapi resesi."
            },
            {
                question: "Perhatikan gambar artefak sejarah Indonesia! Fungsi utama candi pada masa Hindu-Buddha selain sebagai tempat ibadah adalah...",
                options: [
                    "A. Pusat perdagangan",
                    "B. Tempat tinggal raja",
                    "C. Benteng pertahanan",
                    "D. Tempat pemakaman raja",
                    "E. Pusat pendidikan dan kebudayaan"
                ],
                correctAnswer: 4,
                explanation: "Candi berfungsi sebagai: 1) Tempat ibadah, 2) Pusat pendidikan (kitab, relief), 3) Simbol kekuasaan raja, 4) Pusat kebudayaan (seni, arsitektur). Beberapa candi juga berfungsi sebagai makam (contoh: candi Hindu), tetapi fungsi utamanya lebih luas sebagai pusat aktivitas keagamaan dan budaya."
            },
            {
                question: "Perhatikan grafik pertumbuhan ekonomi Indonesia! Faktor internal yang paling mempengaruhi pertumbuhan ekonomi Indonesia berdasarkan grafik adalah...",
                options: [
                    "A. Harga minyak dunia",
                    "B. Permintaan pasar global",
                    "C. Investasi dalam negeri",
                    "D. Kebijakan moneter The Fed",
                    "E. Perkembangan ekonomi Tiongkok"
                ],
                correctAnswer: 2,
                explanation: "Faktor internal utama pertumbuhan ekonomi Indonesia: 1) Investasi dalam negeri (PMDN), 2) Konsumsi rumah tangga, 3) Belanja pemerintah. Harga minyak, permintaan global, dan ekonomi Tiongkok adalah faktor eksternal. The Fed mempengaruhi tetapi bukan faktor internal."
            },
            {
                question: "Perhatikan tabel lembaga negara berikut:\n1) Mahkamah Konstitusi\n2) Komisi Yudisial\n3) Komisi Pemberantasan Korupsi\n4) Ombudsman\nLembaga yang berwenang menguji undang-undang terhadap UUD 1945 adalah...",
                options: [
                    "A. 1",
                    "B. 2",
                    "C. 3",
                    "D. 4",
                    "E. 1 dan 2"
                ],
                correctAnswer: 0,
                explanation: "Mahkamah Konstitusi (MK) berwenang menguji undang-undang terhadap UUD 1945 (judicial review). Komisi Yudisial mengawasi hakim, KPK memberantas korupsi, Ombudsman menangani pengaduan pelayanan publik. MK juga berwenang memutus sengketa kewenangan lembaga negara dan pembubaran partai."
            },
            {
                question: "Perhatikan peta jalur perdagangan rempah dunia! Faktor yang menyebabkan rempah-rempah Indonesia sangat diminati bangsa Eropa abad ke-16 adalah...",
                options: [
                    "A. Harga yang sangat murah",
                    "B. Kualitas dan aroma yang unik",
                    "C. Kemudahan transportasi",
                    "D. Tidak ada saingan dari negara lain",
                    "E. Teknik budidaya yang modern"
                ],
                correctAnswer: 1,
                explanation: "Rempah Indonesia (pala, cengkih, lada) sangat diminati karena: 1) Kualitas tinggi, 2) Aroma dan rasa khas, 3) Kegunaan sebagai pengawet makanan, bumbu, dan obat. Harga sebenarnya mahal karena langka di Eropa, transportasi sulit, dan ada saingan dari India/Timur Tengah."
            }
        ]
    }
};

// Add more questions to reach 100 for each level and subject
// SD IPA (already has 10, need 10 more)
for (let i = 0; i < 10; i++) {
    QUESTION_BANK['SD']['IPA'].push({
        question: `Soal SD IPA tambahan ${i+11}: Proses perubahan wujud dari gas menjadi cair disebut...`,
        options: [
            "A. Membeku",
            "B. Mencair",
            "C. Menguap",
            "D. Mengembun",
            "E. Menyublim"
        ],
        correctAnswer: 3,
        explanation: `Penjelasan untuk soal SD IPA tambahan ${i+11}: Mengembun adalah proses perubahan wujud dari gas menjadi cair, contohnya ketika uap air di udara berubah menjadi titik-titik air di daun di pagi hari.`
    });
}

// SD IPS (already has 10, need 10 more)
for (let i = 0; i < 10; i++) {
    QUESTION_BANK['SD']['IPS'].push({
        question: `Soal SD IPS tambahan ${i+11}: Mata uang resmi yang digunakan di Jepang adalah...`,
        options: [
            "A. Dollar",
            "B. Euro",
            "C. Yen",
            "D. Won",
            "E. Ringgit"
        ],
        correctAnswer: 2,
        explanation: `Penjelasan untuk soal SD IPS tambahan ${i+11}: Yen adalah mata uang resmi Jepang. Simbol untuk yen adalah , dan kode ISO-nya adalah JPY.`
    });
}

// SMP IPA (already has 10, need 10 more)
for (let i = 0; i < 10; i++) {
    QUESTION_BANK['SMP']['IPA'].push({
        question: `Soal SMP IPA tambahan ${i+11}: Besaran yang satuannya dinyatakan dalam joule adalah...`,
        options: [
            "A. Gaya",
            "B. Daya",
            "C. Usaha",
            "D. Tekanan",
            "E. Massa"
        ],
        correctAnswer: 2,
        explanation: `Penjelasan untuk soal SMP IPA tambahan ${i+11}: Joule adalah satuan untuk usaha dan energi. Usaha didefinisikan sebagai gaya kali perpindahan (W = F  s).`
    });
}

// SMP IPS (already has 10, need 10 more)
for (let i = 0; i < 10; i++) {
    QUESTION_BANK['SMP']['IPS'].push({
        question: `Soal SMP IPS tambahan ${i+11}: Lembaga negara yang bertugas membuat undang-undang adalah...`,
        options: [
            "A. Presiden",
            "B. DPR",
            "C. Mahkamah Agung",
            "D. BPK",
            "E. KPK"
        ],
        correctAnswer: 1,
        explanation: `Penjelasan untuk soal SMP IPS tambahan ${i+11}: DPR (Dewan Perwakilan Rakyat) adalah lembaga legislatif yang bertugas membuat undang-undang bersama Presiden.`
    });
}

// SMA IPA (already has 10, need 10 more)
for (let i = 0; i < 10; i++) {
    QUESTION_BANK['SMA/SMK']['IPA'].push({
        question: `Soal SMA IPA tambahan ${i+11}: Senyawa dengan rumus molekul CHOH termasuk dalam golongan...`,
        options: [
            "A. Alkanon",
            "B. Alkanal",
            "C. Alkanol",
            "D. Alkanoat",
            "E. Alkuna"
        ],
        correctAnswer: 2,
        explanation: `Penjelasan untuk soal SMA IPA tambahan ${i+11}: CHOH (etanol) termasuk alkohol (alkanol) karena memiliki gugus fungsi -OH yang terikat pada atom karbon jenuh.`
    });
}

// SMA IPS (already has 10, need 10 more)
for (let i = 0; i < 10; i++) {
    QUESTION_BANK['SMA/SMK']['IPS'].push({
        question: `Soal SMA IPS tambahan ${i+11}: Kebijakan moneter yang dilakukan bank sentral untuk mengatasi inflasi adalah...`,
        options: [
            "A. Menurunkan suku bunga",
            "B. Meningkatkan giro wajib minimum",
            "C. Membeli surat berharga di pasar",
            "D. Meningkatkan belanja pemerintah",
            "E. Menurunkan pajak penghasilan"
        ],
        correctAnswer: 1,
        explanation: `Penjelasan untuk soal SMA IPS tambahan ${i+11}: Untuk mengatasi inflasi, bank sentral dapat melakukan kebijakan moneter kontraktif seperti menaikkan GWM (Giro Wajib Minimum) untuk mengurangi jumlah uang beredar.`
    });
}

// Save the updated question bank to localStorage
localStorage.setItem('questionBank', JSON.stringify(QUESTION_BANK));

        // Load questions from localStorage if available
        const savedQuestions = JSON.parse(localStorage.getItem('questionBank'));
        if (savedQuestions) {
            QUESTION_BANK = savedQuestions;
        } else {
            // Save initial questions to localStorage
            localStorage.setItem('questionBank', JSON.stringify(QUESTION_BANK));
        }
        
        // Motivational messages based on score
        const MOTIVATIONAL_MESSAGES = {
            '90-100': 'Sempurna! Anda sangat luar biasa dalam menguasai materi ini. Pertahankan prestasi ini.',
            '80-89': 'Hasil yang sangat baik! Anda telah menunjukkan pemahaman yang mendalam tentang materi.',
            '70-79': 'Kerja bagus! Anda memiliki pemahaman yang baik tentang materi ini.',
            '60-69': 'Hasil yang cukup baik. Tingkatkan lagi pemahaman Anda untuk hasil yang lebih baik.',
            '50-59': 'Anda sudah memahami dasar-dasarnya. Terus berlatih untuk meningkatkan pemahaman.',
            '0-49': 'Jangan menyerah! Gunakan hasil ini sebagai motivasi untuk belajar lebih giat lagi.'
        };
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize particles.js for background
            particlesJS('particles-js', {
                "particles": {
                    "number": {
                        "value": 80,
                        "density": {
                            "enable": true,
                            "value_area": 800
                        }
                    },
                    "color": {
                        "value": "#ffffff"
                    },
                    "shape": {
                        "type": "circle",
                        "stroke": {
                            "width": 0,
                            "color": "#000000"
                        },
                        "polygon": {
                            "nb_sides": 5
                        }
                    },
                    "opacity": {
                        "value": 0.5,
                        "random": false,
                        "anim": {
                            "enable": false,
                            "speed": 1,
                            "opacity_min": 0.1,
                            "sync": false
                        }
                    },
                    "size": {
                        "value": 3,
                        "random": true,
                        "anim": {
                            "enable": false,
                            "speed": 40,
                            "size_min": 0.1,
                            "sync": false
                        }
                    },
                    "line_linked": {
                        "enable": true,
                        "distance": 150,
                        "color": "#ffffff",
                        "opacity": 0.4,
                        "width": 1
                    },
                    "move": {
                        "enable": true,
                        "speed": 2,
                        "direction": "none",
                        "random": false,
                        "straight": false,
                        "out_mode": "out",
                        "bounce": false,
                        "attract": {
                            "enable": false,
                            "rotateX": 600,
                            "rotateY": 1200
                        }
                    }
                },
                "interactivity": {
                    "detect_on": "canvas",
                    "events": {
                        "onhover": {
                            "enable": true,
                            "mode": "grab"
                        },
                        "onclick": {
                            "enable": true,
                            "mode": "push"
                        },
                        "resize": true
                    },
                    "modes": {
                        "grab": {
                            "distance": 140,
                            "line_linked": {
                                "opacity": 1
                            }
                        },
                        "bubble": {
                            "distance": 400,
                            "size": 40,
                            "duration": 2,
                            "opacity": 8,
                            "speed": 3
                        },
                        "repulse": {
                            "distance": 200,
                            "duration": 0.4
                        },
                        "push": {
                            "particles_nb": 4
                        },
                        "remove": {
                            "particles_nb": 2
                        }
                    }
                },
                "retina_detect": true
            });
            
            // Initialize celebration particles (hidden by default)
            particlesJS('celebration-particles', {
                "particles": {
                    "number": {
                        "value": 150,
                        "density": {
                            "enable": true,
                            "value_area": 800
                        }
                    },
                    "color": {
                        "value": ["#FF0000", "#00FF00", "#0000FF", "#FFFF00", "#FF00FF", "#00FFFF"]
                    },
                    "shape": {
                        "type": ["circle", "triangle", "star"],
                        "stroke": {
                            "width": 0,
                            "color": "#000000"
                        },
                        "polygon": {
                            "nb_sides": 5
                        }
                    },
                    "opacity": {
                        "value": 0.7,
                        "random": true,
                        "anim": {
                            "enable": true,
                            "speed": 1,
                            "opacity_min": 0.1,
                            "sync": false
                        }
                    },
                    "size": {
                        "value": 5,
                        "random": true,
                        "anim": {
                            "enable": true,
                            "speed": 4,
                            "size_min": 0.3,
                            "sync": false
                        }
                    },
                    "line_linked": {
                        "enable": false
                    },
                    "move": {
                        "enable": true,
                        "speed": 6,
                        "direction": "none",
                        "random": true,
                        "straight": false,
                        "out_mode": "out",
                        "bounce": false,
                        "attract": {
                            "enable": false,
                            "rotateX": 600,
                            "rotateY": 1200
                        }
                    }
                },
                "interactivity": {
                    "detect_on": "canvas",
                    "events": {
                        "onhover": {
                            "enable": false
                        },
                        "onclick": {
                            "enable": false
                        },
                        "resize": true
                    }
                },
                "retina_detect": true
            });
            
            // Load admin settings
            loadAdminSettings();
            
            // Set greeting message from admin settings
            document.getElementById('greeting-text').textContent = adminSettings.greetingMessage;
            document.getElementById('admin-message').textContent = adminSettings.adminMessage;
            
            // Event listeners for buttons with sound
            document.querySelectorAll('button').forEach(button => {
                button.addEventListener('click', function() {
                    // Play button sound if not disabled
                    if (!this.disabled) {
                        buttonSound.currentTime = 0;
                        buttonSound.play().catch(e => console.log("Button sound prevented:", e));
                    }
                });
            });
            
            // Event listeners
            document.getElementById('login-btn').addEventListener('click', handleLogin);
            document.getElementById('agree-terms').addEventListener('change', toggleContinueButton);
            document.getElementById('continue-btn').addEventListener('click', showParticipantForm);
            
            // Status radio buttons
            document.querySelectorAll('input[name="status"]').forEach(radio => {
                radio.addEventListener('change', toggleParticipantFields);
            });
            
            // School level radio buttons
            document.querySelectorAll('input[name="level"]').forEach(radio => {
                radio.addEventListener('change', showGradeSelection);
            });
            
            document.getElementById('save-participant-btn').addEventListener('click', startExam);
            document.getElementById('finish-exam-btn').addEventListener('click', finishExam);
            document.getElementById('skip-question-btn').addEventListener('click', skipQuestion);
            document.getElementById('unanswered-btn').addEventListener('click', showUnansweredQuestions);
            document.getElementById('print-certificate-btn').addEventListener('click', printCertificate);
            document.getElementById('retake-exam-btn').addEventListener('click', retakeExam);
            
            // Floating buttons
            document.getElementById('whatsapp-btn').addEventListener('click', contactAdmin);
            document.getElementById('question-bank-btn').addEventListener('click', showQuestionBankModal);
            document.getElementById('admin-panel-btn').addEventListener('click', showAdminPanelModal);
            
            // Modal close buttons
            document.getElementById('close-question-bank-modal').addEventListener('click', hideQuestionBankModal);
            document.getElementById('close-admin-panel-modal').addEventListener('click', hideAdminPanelModal);
            document.getElementById('close-edit-question-modal').addEventListener('click', hideEditQuestionModal);
            document.getElementById('close-edit-participant-modal').addEventListener('click', hideEditParticipantModal);
            
            // Modal submit buttons
            document.getElementById('submit-question-bank-code').addEventListener('click', submitQuestionBankCode);
            document.getElementById('submit-admin-panel-code').addEventListener('click', submitAdminPanelCode);
            
            // Check form validity when fields change
            document.getElementById('fullname').addEventListener('input', function() {
                // Convert input to uppercase automatically
                this.value = this.value.toUpperCase();
                checkParticipantFormValidity();
            });
            
            document.getElementById('school-name').addEventListener('input', checkParticipantFormValidity);
            document.getElementById('student-id').addEventListener('input', checkParticipantFormValidity);
            document.querySelectorAll('input[name="purpose"]').forEach(radio => {
                radio.addEventListener('change', checkParticipantFormValidity);
            });
            document.querySelectorAll('input[name="level"]').forEach(radio => {
                radio.addEventListener('change', checkParticipantFormValidity);
            });
            document.querySelectorAll('input[name="grade"]').forEach(radio => {
                radio.addEventListener('change', checkParticipantFormValidity);
            });
            document.querySelectorAll('input[name="subject"]').forEach(radio => {
                radio.addEventListener('change', checkParticipantFormValidity);
            });

            // Admin panel toggle switches
            document.querySelectorAll('.toggle-switch input').forEach(toggle => {
                toggle.addEventListener('change', function() {
                    const statusElement = document.getElementById(`${this.id}-status`);
                    statusElement.textContent = this.checked ? 'Aktif' : 'Nonaktif';
                });
            });

            // Question bank buttons
            document.getElementById('add-question-btn').addEventListener('click', addQuestionToBank);
            document.getElementById('filter-level').addEventListener('change', filterQuestions);
            document.getElementById('filter-category').addEventListener('change', filterQuestions);
            
            // Image preview for new question
            document.getElementById('question-image').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    // Check file size (max 500KB)
                    if (file.size > 500 * 1024) {
                        showAlert('Ukuran gambar terlalu besar. Maksimal 500KB.', 'danger');
                        this.value = '';
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const preview = document.getElementById('question-image-preview');
                        preview.src = event.target.result;
                        preview.style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Image preview for edit question
            document.getElementById('edit-question-image').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    // Check file size (max 500KB)
                    if (file.size > 500 * 1024) {
                        showAlert('Ukuran gambar terlalu besar. Maksimal 500KB.', 'danger');
                        this.value = '';
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const preview = document.getElementById('edit-question-image-preview');
                        preview.src = event.target.result;
                        preview.style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Edit question modal buttons
            document.getElementById('save-edit-question-btn').addEventListener('click', saveEditedQuestion);
            document.getElementById('delete-question-btn').addEventListener('click', deleteQuestion);
            
            // Admin panel buttons
            document.getElementById('save-codes-btn').addEventListener('click', saveCodes);
            document.getElementById('save-content-btn').addEventListener('click', saveContent);
            document.getElementById('save-settings-btn').addEventListener('click', saveSettings);
            
            // Participant management buttons
            document.getElementById('select-all-participants').addEventListener('click', toggleSelectAllParticipants);
            document.getElementById('edit-selected-participants').addEventListener('click', editSelectedParticipants);
            document.getElementById('delete-selected-participants').addEventListener('click', deleteSelectedParticipants);
            document.getElementById('validate-certificate-btn').addEventListener('click', validateCertificate);
            
            // Search functionality
            document.getElementById('participant-search').addEventListener('input', searchParticipants);
            
            // Edit participant form
            document.getElementById('save-edit-participant-btn').addEventListener('click', saveEditedParticipant);
            document.querySelectorAll('input[name="edit-status"]').forEach(radio => {
                radio.addEventListener('change', toggleEditParticipantFields);
            });
            document.querySelectorAll('input[name="edit-level"]').forEach(radio => {
                radio.addEventListener('change', showEditGradeSelection);
            });
            
            // Load participants data for admin panel
            loadParticipantsData();
            
            // Auto uppercase for edit fullname field
            document.getElementById('edit-fullname').addEventListener('input', function() {
                this.value = this.value.toUpperCase();
            });
        });
        
        // Functions
        function showAlert(message, type) {
            const alertDiv = document.getElementById('add-question-alert');
            alertDiv.textContent = message;
            alertDiv.className = `alert alert-${type}`;
            alertDiv.style.display = 'block';
            
            // Hide after 5 seconds
            setTimeout(() => {
                alertDiv.style.display = 'none';
            }, 5000);
        }
        
        function saveQuestionBank() {
            localStorage.setItem('questionBank', JSON.stringify(QUESTION_BANK));
        }
        
        function saveParticipantsData() {
            localStorage.setItem('participantsData', JSON.stringify(participantsData));
        }
        
        function saveAdminSettings() {
            localStorage.setItem('adminSettings', JSON.stringify(adminSettings));
        }
        
        function loadAdminSettings() {
            // Load exam duration
            document.getElementById('exam-duration').value = adminSettings.examDuration;
            
            // Load question count
            document.getElementById('question-count').value = adminSettings.questionCount;
            
            // Load randomize questions setting
            document.getElementById('randomize-questions').checked = adminSettings.randomizeQuestions;
            document.getElementById('randomize-status').textContent = adminSettings.randomizeQuestions ? 'Aktif' : 'Nonaktif';
            
            // Load greeting message
            document.getElementById('greeting-message-input').value = adminSettings.greetingMessage;
            
            // Load admin message
            document.getElementById('admin-message-input').value = adminSettings.adminMessage;
            
            // Load chairman name
            document.getElementById('chairman-name').value = adminSettings.chairmanName;
            
            // Load subject toggles
            document.getElementById('toggle-science').checked = adminSettings.enabledSubjects.IPA;
            document.getElementById('science-status').textContent = adminSettings.enabledSubjects.IPA ? 'Aktif' : 'Nonaktif';
            
            document.getElementById('toggle-social').checked = adminSettings.enabledSubjects.IPS;
            document.getElementById('social-status').textContent = adminSettings.enabledSubjects.IPS ? 'Aktif' : 'Nonaktif';
        }
        
        function handleLogin() {
            const loginCode = document.getElementById('login-code').value;
            
            if (loginCode === adminSettings.loginCode) {
                // Play opening sound
                openingSound.play().catch(e => console.log("Opening sound prevented:", e));
                
                // Hide welcome screen with slide out animation
                document.getElementById('welcome-screen').classList.add('slide-out');
                
                // Show terms screen after animation completes
                setTimeout(() => {
                    document.getElementById('welcome-screen').style.display = 'none';
                    document.getElementById('terms-screen').style.display = 'block';
                    document.getElementById('terms-screen').classList.add('slide-in');
                    currentScreen = 'terms';
                }, 500);
            } else {
                alert('Kode login salah. Silakan coba lagi.');
            }
        }
        
        function toggleContinueButton() {
            const agreeCheckbox = document.getElementById('agree-terms');
            document.getElementById('continue-btn').disabled = !agreeCheckbox.checked;
        }
        
        function showParticipantForm() {
            // Hide terms screen with slide out animation
            document.getElementById('terms-screen').classList.add('slide-out');
            
            // Show participant form after animation completes
            setTimeout(() => {
                document.getElementById('terms-screen').style.display = 'none';
                document.getElementById('participant-form').style.display = 'block';
                document.getElementById('participant-form').classList.add('slide-in');
                currentScreen = 'participant';
            }, 500);
        }
        
        function toggleParticipantFields() {
            // Only student status is available now
            document.getElementById('student-fields').style.display = 'block';
            checkParticipantFormValidity();
        }
        
        function showGradeSelection() {
            const level = document.querySelector('input[name="level"]:checked').value;
            const gradeOptions = document.getElementById('grade-options');
            
            // Clear previous options
            gradeOptions.innerHTML = '';
            
            // Add options based on level
            if (level === 'SD') {
                addGradeOption('grade-4', 'Kelas <span class="roman">IV</span>', '4');
                addGradeOption('grade-5', 'Kelas <span class="roman">V</span>', '5');
                addGradeOption('grade-6', 'Kelas <span class="roman">VI</span>', '6');
            } else if (level === 'SMP') {
                addGradeOption('grade-7', 'Kelas <span class="roman">VII</span>', '7');
                addGradeOption('grade-8', 'Kelas <span class="roman">VIII</span>', '8');
                addGradeOption('grade-9', 'Kelas <span class="roman">IX</span>', '9');
            } else if (level === 'SMA/SMK') {
                addGradeOption('grade-10', 'Kelas <span class="roman">X</span>', '10');
                addGradeOption('grade-11', 'Kelas <span class="roman">XI</span>', '11');
                addGradeOption('grade-12', 'Kelas <span class="roman">XII</span>', '12');
            }
            
            document.getElementById('grade-selection').style.display = 'block';
            checkParticipantFormValidity();
        }
        
        function addGradeOption(id, label, value) {
            const container = document.getElementById('grade-options');
            
            const radio = document.createElement('input');
            radio.type = 'radio';
            radio.id = id;
            radio.name = 'grade';
            radio.value = value;
            radio.className = 'radio-option';
            
            const radioLabel = document.createElement('label');
            radioLabel.htmlFor = id;
            radioLabel.className = 'radio-label';
            radioLabel.innerHTML = label;
            
            // Add event listener for grade selection
            radio.addEventListener('change', function() {
                document.getElementById('subject-selection').style.display = 'block';
                checkParticipantFormValidity();
            });
            
            container.appendChild(radio);
            container.appendChild(radioLabel);
        }
        
        function checkParticipantFormValidity() {
            let isValid = true;
            
            // Check common fields
            const fullname = document.getElementById('fullname').value.trim();
            if (!fullname || !/^[A-Za-z ]+$/.test(fullname)) {
                isValid = false;
            }
            
            // Check student fields
            if (!document.getElementById('school-name').value.trim()) {
                isValid = false;
            }
            
            const studentId = document.getElementById('student-id').value.trim();
            if (!studentId || !/^[0-9]+$/.test(studentId)) {
                isValid = false;
            }
            
            if (!document.querySelector('input[name="purpose"]:checked')) {
                isValid = false;
            }
            
            if (!document.querySelector('input[name="level"]:checked')) {
                isValid = false;
            }
            
            if (!document.querySelector('input[name="grade"]:checked')) {
                isValid = false;
            }
            
            if (!document.querySelector('input[name="subject"]:checked')) {
                isValid = false;
            }
            
            document.getElementById('save-participant-btn').disabled = !isValid;
        }
        
        function startExam() {
            // Collect participant data
            participantData = {
                fullname: document.getElementById('fullname').value.trim(),
                status: 'pelajar',
                purpose: document.querySelector('input[name="purpose"]:checked')?.value,
                level: document.querySelector('input[name="level"]:checked')?.value,
                grade: document.querySelector('input[name="grade"]:checked')?.value,
                subject: document.querySelector('input[name="subject"]:checked')?.value,
                school: document.getElementById('school-name')?.value.trim(),
                studentId: document.getElementById('student-id')?.value.trim(),
                examDate: new Date().toISOString()
            };
            
            // Load questions based on level and subject
            if (participantData.level && participantData.subject && QUESTION_BANK[participantData.level][participantData.subject]) {
                questions = QUESTION_BANK[participantData.level][participantData.subject];
            } else {
                // Default questions if subject not found
                questions = QUESTION_BANK['SD']['IPA'];
            }
            
            // Randomize questions if setting is enabled
            if (adminSettings.randomizeQuestions) {
                questions = shuffleArray(questions).slice(0, adminSettings.questionCount);
            } else {
                questions = questions.slice(0, adminSettings.questionCount);
            }
            
            // Initialize exam data
            examData = {
                startTime: new Date(),
                answered: 0,
                correct: 0,
                wrong: 0,
                unanswered: questions.length,
                answers: Array(questions.length).fill(null)
            };
            
            // Set exam time from admin settings
            examTimeLeft = adminSettings.examDuration * 60;
            
            // Hide participant form with slide out animation
            document.getElementById('participant-form').classList.add('slide-out');
            
            // Show exam screen after animation completes
            setTimeout(() => {
                document.getElementById('participant-form').style.display = 'none';
                document.getElementById('exam-screen').style.display = 'block';
                document.getElementById('exam-screen').classList.add('slide-in');
                currentScreen = 'exam';
                
                // Start timer
                startTimer();
                
                // Load first question
                loadQuestion(0);
            }, 500);
        }
        
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }
        
        function startTimer() {
            // Update timer display immediately
            updateTimerDisplay();
            
            // Start timer interval
            examTimer = setInterval(function() {
                examTimeLeft--;
                updateTimerDisplay();
                
                // Check if time is up
                if (examTimeLeft <= 0) {
                    clearInterval(examTimer);
                    finishExam();
                }
                
                // Show warning when 10 minutes left
                if (examTimeLeft === 600) { // 10 minutes = 600 seconds
                    showTimeWarning();
                }
                
                // Hide warning when 1 minute left
                if (examTimeLeft === 60) {
                    hideTimeWarning();
                }
            }, 1000);
        }
        
        function updateTimerDisplay() {
            const hours = Math.floor(examTimeLeft / 3600);
            const minutes = Math.floor((examTimeLeft % 3600) / 60);
            const seconds = examTimeLeft % 60;
            
            const timerElement = document.getElementById('exam-timer');
            timerElement.textContent = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Change style based on remaining time
            if (examTimeLeft <= 600) { // 10 minutes or less
                timerElement.classList.add('timer-warning');
                
                if (examTimeLeft <= 60) { // 1 minute or less
                    timerElement.classList.remove('timer-warning');
                    timerElement.classList.add('timer-danger');
                }
            } else {
                timerElement.classList.remove('timer-warning', 'timer-danger');
            }
        }
        
        function showTimeWarning() {
            const notification = document.getElementById('time-warning');
            notification.style.display = 'block';
            
            // Auto hide after 9 minutes (540 seconds)
            setTimeout(() => {
                notification.style.display = 'none';
            }, 540 * 1000);
        }
        
        function hideTimeWarning() {
            document.getElementById('time-warning').style.display = 'none';
        }
        
        function loadQuestion(index) {
            if (index < 0 || index >= questions.length) return;
            
            currentQuestionIndex = index;
            const question = questions[index];
            
            // Update question text
            document.getElementById('question-text').textContent = `Soal ${index + 1}: ${question.question}`;
            
            // Clear previous image if exists
            const imageContainer = document.getElementById('question-image-container');
            imageContainer.innerHTML = '';
            
            // Add image if exists
            if (question.image) {
                const img = document.createElement('img');
                img.src = question.image;
                img.style.maxWidth = '100%';
                img.style.maxHeight = '200px';
                img.style.marginBottom = '15px';
                img.style.display = 'block';
                imageContainer.appendChild(img);
            }
            
            // Clear previous options
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';
            
            // Add new options
            question.options.forEach((option, i) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = option;
                
                // Check if this question was already answered
                if (examData.answers[index] !== null) {
                    if (examData.answers[index] === i) {
                        if (i === question.correctAnswer) {
                            optionElement.classList.add('correct');
                        } else {
                            optionElement.classList.add('incorrect');
                        }
                    } else if (i === question.correctAnswer) {
                        optionElement.classList.add('correct');
                    }
                    
                    // Show explanation if answered
                    document.getElementById('explanation-text').style.display = 'block';
                    document.getElementById('explanation-text').innerHTML = `<strong>Penjelasan:</strong> ${question.explanation}`;
                } else {
                    // Add click event for unanswered questions
                    optionElement.addEventListener('click', function() {
                        selectAnswer(index, i);
                    });
                }
                
                optionsContainer.appendChild(optionElement);
            });
            
            // Hide explanation if question not answered
            if (examData.answers[index] === null) {
                document.getElementById('explanation-text').style.display = 'none';
            }
        }
        
        function selectAnswer(questionIndex, answerIndex) {
            const question = questions[questionIndex];
            
            // Record answer
            examData.answers[questionIndex] = answerIndex;
            
            // Update counters
            examData.answered++;
            examData.unanswered--;
            
            if (answerIndex === question.correctAnswer) {
                examData.correct++;
                // Play correct answer sound
                correctAnswerSound.currentTime = 0;
                correctAnswerSound.play().catch(e => console.log("Correct answer sound prevented:", e));
            } else {
                examData.wrong++;
                // Play wrong answer sound
                wrongAnswerSound.currentTime = 0;
                wrongAnswerSound.play().catch(e => console.log("Wrong answer sound prevented:", e));
            }
            
            // Reload question to show result
            loadQuestion(questionIndex);
            
            // Auto move to next question after delay if not last question
            if (questionIndex < questions.length - 1) {
                setTimeout(() => {
                    loadQuestion(questionIndex + 1);
                }, 2000);
            }
        }
        
        function skipQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                loadQuestion(currentQuestionIndex + 1);
            }
        }
        
        function showUnansweredQuestions() {
            // Find first unanswered question
            const unansweredIndex = examData.answers.findIndex(answer => answer === null);
            
            if (unansweredIndex !== -1) {
                loadQuestion(unansweredIndex);
            } else {
                alert('Semua soal sudah dijawab.');
            }
        }
        
        function finishExam() {
            clearInterval(examTimer);
            
            // Calculate unanswered questions
            examData.unanswered = examData.answers.filter(answer => answer === null).length;
            
            // Generate certificate code
            const certificateCode = generateUniqueCode();
            
            // Add participant to data store
            const score = Math.round((examData.correct / questions.length) * 100);
            participantsData.push({
                ...participantData,
                score: score,
                examDate: new Date().toISOString(),
                certificateCode: certificateCode
            });
            saveParticipantsData();
            
            // Hide exam screen with slide out animation
            document.getElementById('exam-screen').classList.add('slide-out');
            
            // Show results screen after animation completes
            setTimeout(() => {
                document.getElementById('exam-screen').style.display = 'none';
                document.getElementById('results-screen').style.display = 'block';
                document.getElementById('results-screen').classList.add('slide-in');
                currentScreen = 'results';
                
                // Display results
                displayResults();
                
                // Generate certificate
                generateCertificate(certificateCode);
                
                // Show celebration particles
                showCelebration();
                
                // Play certificate sound (applause)
                certificateSound.currentTime = 0;
                certificateSound.play().catch(e => console.log("Certificate sound prevented:", e));
            }, 500);
        }
        
        function displayResults() {
            document.getElementById('result-name').textContent = participantData.fullname;
            document.getElementById('result-status').textContent = 'Pelajar';
            document.getElementById('result-level').textContent = participantData.level || '-';
            document.getElementById('result-grade').textContent = participantData.grade ? `Kelas ${participantData.grade}` : '-';
            document.getElementById('result-subject').textContent = participantData.subject || '-';
            document.getElementById('total-questions').textContent = questions.length;
            document.getElementById('correct-answers').textContent = examData.correct;
            document.getElementById('wrong-answers').textContent = examData.wrong;
            document.getElementById('unanswered-questions').textContent = examData.unanswered;
            
            // Calculate score (percentage)
            const score = Math.round((examData.correct / questions.length) * 100);
            document.getElementById('exam-score').textContent = `${score}%`;
        }
        
        function generateCertificate(certificateCode) {
            const certificateContainer = document.getElementById('certificate-container');
            certificateContainer.innerHTML = '';
            
            // Calculate score
            const score = Math.round((examData.correct / questions.length) * 100);
            
            // Get current date
            const now = new Date();
            const dateString = now.toLocaleDateString('id-ID', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            }).replace(/\//g, '');
            
            // Get motivational message based on score
            let motivation = '';
            for (const range in MOTIVATIONAL_MESSAGES) {
                const [min, max] = range.split('-').map(Number);
                if (score >= min && score <= max) {
                    motivation = MOTIVATIONAL_MESSAGES[range];
                    break;
                }
            }
            
            // Create certificate HTML
            const certificate = document.createElement('div');
            certificate.className = 'certificate';
            
            certificate.innerHTML = `
                <div class="certificate-content">
                    <h1 class="certificate-title">SERTIFIKAT PRESTASI</h1>
                    <p class="certificate-code">${formatName(participantData.fullname)}/PELAJAR/${participantData.level || 'UMUM'}/${participantData.subject || 'UMUM'}/${dateString}/${certificateCode}/PERGUNU-STB</p>
                    <p>Diberikan Kepada</p>
                    <h2 class="certificate-recipient">${formatName(participantData.fullname)}</h2>
                    <p class="certificate-body">
                        Atas Partisipasi & Pencapaian Luar Biasa Dalam<br>
                        Ujian Pergunu Situbondo
                    </p>
                    <p class="certificate-body">
                        Sebagai penghargaan atas dedikasi dalam memahami materi ujian dan mengasah logika, 
                        sertifikat ini diberikan sebagai motivasi untuk terus berkembang.
                    </p>
                    <div class="certificate-score">Nilai: ${score}%</div>
                    <p class="certificate-motivation">${motivation}</p>
                    <div class="certificate-footer">
                        <p>Ditetapkan di: Situbondo, ${now.toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' })}</p>
                        <div class="certificate-signature">
                            <p>Ketua Pergunu Situbondo</p>
                            <p><strong>${adminSettings.chairmanName}</strong></p>
                        </div>
                        <img src="https://raw.githubusercontent.com/pergunu/ujian-online/main/assets/images/BARCODE.png" alt="Barcode" class="certificate-barcode">
                    </div>
                </div>
            `;
            
            certificateContainer.appendChild(certificate);
            certificateContainer.style.display = 'block';
        }
        
        function showCelebration() {
            // Show celebration particles
            document.getElementById('celebration-particles').style.display = 'block';
            
            // Hide after 5 seconds
            setTimeout(() => {
                document.getElementById('celebration-particles').style.display = 'none';
            }, 5000);
        }
        
        function formatName(name) {
            return name.split(' ').map(word => 
                word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()
            ).join(' ');
        }
        
        function generateUniqueCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let result = '';
            
            for (let i = 0; i < 4; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            
            result += '-';
            
            for (let i = 0; i < 4; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            
            return result;
        }
        
        function printCertificate() {
            // Hide floating buttons
            document.querySelector('.floating-buttons').style.display = 'none';
            
            // Hide other elements in results screen
            document.querySelector('.results-summary').style.display = 'none';
            document.querySelector('.result-actions').style.display = 'none';
            
            // Print the certificate
            window.print();
            
            // Show elements again after printing
            setTimeout(() => {
                document.querySelector('.floating-buttons').style.display = 'flex';
                document.querySelector('.results-summary').style.display = 'block';
                document.querySelector('.result-actions').style.display = 'block';
            }, 500);
        }
        
        function retakeExam() {
            // Hide results screen with slide out animation
            document.getElementById('results-screen').classList.add('slide-out');
            
            // Show participant form after animation completes
            setTimeout(() => {
                document.getElementById('results-screen').style.display = 'none';
                document.getElementById('participant-form').style.display = 'block';
                document.getElementById('participant-form').classList.add('slide-in');
                currentScreen = 'participant';
                
                // Reset timer
                examTimeLeft = adminSettings.examDuration * 60;
            }, 500);
        }
        
        function contactAdmin() {
            const message = encodeURIComponent("Assalamualaikum mas admin, saya mau tanya sesuatu nih...");
            window.open(`https://wa.me/6285647709114?text=${message}`, '_blank');
        }
        
        function showQuestionBankModal() {
            document.getElementById('question-bank-modal').style.display = 'flex';
        }
        
        function hideQuestionBankModal() {
            document.getElementById('question-bank-modal').style.display = 'none';
        }
        
        function submitQuestionBankCode() {
            const code = document.getElementById('question-bank-code').value;
            
            if (code === adminSettings.questionBankCode) {
                // Show question bank content
                document.getElementById('question-bank-content').style.display = 'block';
                filterQuestions();
            } else {
                alert('Kode bank soal salah. Silakan coba lagi.');
            }
        }
        
        function showAdminPanelModal() {
            document.getElementById('admin-panel-modal').style.display = 'flex';
        }
        
        function hideAdminPanelModal() {
            document.getElementById('admin-panel-modal').style.display = 'none';
        }
        
        function submitAdminPanelCode() {
            const code = document.getElementById('admin-panel-code').value;
            
            if (code === adminSettings.adminCode) {
                // Show admin panel content
                document.getElementById('admin-panel-content').style.display = 'block';
            } else {
                alert('Kode admin salah. Silakan coba lagi.');
            }
        }

        function addQuestionToBank() {
            const level = document.getElementById('question-level').value;
            const category = document.getElementById('question-category').value;
            const questionText = document.getElementById('question-text-input').value.trim();
            const options = [
                document.getElementById('option-a').value.trim(),
                document.getElementById('option-b').value.trim(),
                document.getElementById('option-c').value.trim(),
                document.getElementById('option-d').value.trim(),
                document.getElementById('option-e').value.trim()
            ];
            const correctAnswer = parseInt(document.getElementById('correct-answer').value);
            const explanation = document.getElementById('explanation-input').value.trim();
            const imageFile = document.getElementById('question-image').files[0];
            
            // Validate inputs
            if (!questionText) {
                showAlert('Pertanyaan tidak boleh kosong', 'danger');
                return;
            }
            
            if (options.some(opt => !opt)) {
                showAlert('Semua opsi jawaban harus diisi', 'danger');
                return;
            }
            
            if (!explanation) {
                showAlert('Penjelasan tidak boleh kosong', 'danger');
                return;
            }
            
            // Create question object
            const newQuestion = {
                question: questionText,
                options: options.map((opt, i) => `${String.fromCharCode(65 + i)}. ${opt}`),
                correctAnswer: correctAnswer,
                explanation: explanation,
                image: null
            };
            
            // Process image if uploaded
            if (imageFile) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    newQuestion.image = event.target.result;
                    
                    // Add question to bank
                    QUESTION_BANK[level][category].push(newQuestion);
                    
                    // Save to localStorage
                    saveQuestionBank();
                    
                    // Clear form
                    clearQuestionForm();
                    
                    // Refresh questions list
                    filterQuestions();
                    
                    showAlert('Soal berhasil ditambahkan ke bank soal!', 'success');
                };
                reader.readAsDataURL(imageFile);
            } else {
                // Add question to bank without image
                QUESTION_BANK[level][category].push(newQuestion);
                
                // Save to localStorage
                saveQuestionBank();
                
                // Clear form
                clearQuestionForm();
                
                // Refresh questions list
                filterQuestions();
                
                showAlert('Soal berhasil ditambahkan ke bank soal!', 'success');
            }
        }
        
        function clearQuestionForm() {
            document.getElementById('question-text-input').value = '';
            document.getElementById('option-a').value = '';
            document.getElementById('option-b').value = '';
            document.getElementById('option-c').value = '';
            document.getElementById('option-d').value = '';
            document.getElementById('option-e').value = '';
            document.getElementById('explanation-input').value = '';
            document.getElementById('question-image').value = '';
            document.getElementById('question-image-preview').style.display = 'none';
        }
        
        function filterQuestions() {
            const level = document.getElementById('filter-level').value;
            const category = document.getElementById('filter-category').value;
            const questionsList = document.querySelector('.questions-list');
            
            questionsList.innerHTML = '';
            
            if (level === 'all' && category === 'all') {
                let hasQuestions = false;
                
                // Show all questions from all levels and categories
                for (const lvl in QUESTION_BANK) {
                    for (const cat in QUESTION_BANK[lvl]) {
                        if (QUESTION_BANK[lvl][cat].length > 0) {
                            hasQuestions = true;
                            questionsList.innerHTML += `<h6>${lvl} - ${cat}</h6>`;
                            
                            QUESTION_BANK[lvl][cat].forEach((q, i) => {
                                const questionItem = document.createElement('div');
                                questionItem.className = 'question-item';
                                
                                questionItem.innerHTML = `
                                    <p><strong>Soal ${i + 1}:</strong> ${q.question}</p>
                                    ${q.image ? `<img src="${q.image}" style="max-width: 100%; max-height: 100px; margin: 5px 0;">` : ''}
                                    <p>${q.options.join('<br>')}</p>
                                    <p><strong>Jawaban:</strong> ${q.options[q.correctAnswer]}</p>
                                    <p><strong>Penjelasan:</strong> ${q.explanation}</p>
                                    <div class="question-actions">
                                        <button class="question-action-btn edit-btn" data-level="${lvl}" data-category="${cat}" data-index="${i}">
                                            <i class="fas fa-edit"></i> Edit
                                        </button>
                                        <button class="question-action-btn delete-btn" data-level="${lvl}" data-category="${cat}" data-index="${i}">
                                            <i class="fas fa-trash"></i> Hapus
                                        </button>
                                    </div>
                                `;
                                
                                questionsList.appendChild(questionItem);
                            });
                        }
                    }
                }
                
                if (!hasQuestions) {
                    questionsList.innerHTML = '<p id="no-questions-message">Belum ada soal yang tersedia.</p>';
                }
            } else if (level === 'all') {
                // Show all questions from specific category across all levels
                let hasQuestions = false;
                
                for (const lvl in QUESTION_BANK) {
                    if (QUESTION_BANK[lvl][category] && QUESTION_BANK[lvl][category].length > 0) {
                        hasQuestions = true;
                        questionsList.innerHTML += `<h6>${lvl} - ${category}</h6>`;
                        
                        QUESTION_BANK[lvl][category].forEach((q, i) => {
                            const questionItem = document.createElement('div');
                            questionItem.className = 'question-item';
                            
                            questionItem.innerHTML = `
                                <p><strong>Soal ${i + 1}:</strong> ${q.question}</p>
                                ${q.image ? `<img src="${q.image}" style="max-width: 100%; max-height: 100px; margin: 5px 0;">` : ''}
                                <p>${q.options.join('<br>')}</p>
                                <p><strong>Jawaban:</strong> ${q.options[q.correctAnswer]}</p>
                                <p><strong>Penjelasan:</strong> ${q.explanation}</p>
                                <div class="question-actions">
                                    <button class="question-action-btn edit-btn" data-level="${lvl}" data-category="${category}" data-index="${i}">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="question-action-btn delete-btn" data-level="${lvl}" data-category="${category}" data-index="${i}">
                                        <i class="fas fa-trash"></i> Hapus
                                    </button>
                                </div>
                            `;
                            
                            questionsList.appendChild(questionItem);
                        });
                    }
                }
                
                if (!hasQuestions) {
                    questionsList.innerHTML = `<p id="no-questions-message">Belum ada soal yang tersedia untuk kategori ${category}.</p>`;
                }
            } else if (category === 'all') {
                // Show all questions from specific level across all categories
                let hasQuestions = false;
                
                for (const cat in QUESTION_BANK[level]) {
                    if (QUESTION_BANK[level][cat].length > 0) {
                        hasQuestions = true;
                        questionsList.innerHTML += `<h6>${level} - ${cat}</h6>`;
                        
                        QUESTION_BANK[level][cat].forEach((q, i) => {
                            const questionItem = document.createElement('div');
                            questionItem.className = 'question-item';
                            
                            questionItem.innerHTML = `
                                <p><strong>Soal ${i + 1}:</strong> ${q.question}</p>
                                ${q.image ? `<img src="${q.image}" style="max-width: 100%; max-height: 100px; margin: 5px 0;">` : ''}
                                <p>${q.options.join('<br>')}</p>
                                <p><strong>Jawaban:</strong> ${q.options[q.correctAnswer]}</p>
                                <p><strong>Penjelasan:</strong> ${q.explanation}</p>
                                <div class="question-actions">
                                    <button class="question-action-btn edit-btn" data-level="${level}" data-category="${cat}" data-index="${i}">
                                        <i class="fas fa-edit"></i> Edit
                                    </button>
                                    <button class="question-action-btn delete-btn" data-level="${level}" data-category="${cat}" data-index="${i}">
                                        <i class="fas fa-trash"></i> Hapus
                                    </button>
                                </div>
                            `;
                            
                            questionsList.appendChild(questionItem);
                        });
                    }
                }
                
                if (!hasQuestions) {
                    questionsList.innerHTML = `<p id="no-questions-message">Belum ada soal yang tersedia untuk tingkat ${level}.</p>`;
                }
            } else {
                // Show questions from specific level and category
                if (QUESTION_BANK[level][category] && QUESTION_BANK[level][category].length > 0) {
                    QUESTION_BANK[level][category].forEach((q, i) => {
                        const questionItem = document.createElement('div');
                        questionItem.className = 'question-item';
                        
                        questionItem.innerHTML = `
                            <p><strong>Soal ${i + 1}:</strong> ${q.question}</p>
                            ${q.image ? `<img src="${q.image}" style="max-width: 100%; max-height: 100px; margin: 5px 0;">` : ''}
                            <p>${q.options.join('<br>')}</p>
                            <p><strong>Jawaban:</strong> ${q.options[q.correctAnswer]}</p>
                            <p><strong>Penjelasan:</strong> ${q.explanation}</p>
                            <div class="question-actions">
                                <button class="question-action-btn edit-btn" data-level="${level}" data-category="${category}" data-index="${i}">
                                    <i class="fas fa-edit"></i> Edit
                                </button>
                                <button class="question-action-btn delete-btn" data-level="${level}" data-category="${category}" data-index="${i}">
                                    <i class="fas fa-trash"></i> Hapus
                                </button>
                            </div>
                        `;
                        
                        questionsList.appendChild(questionItem);
                    });
                } else {
                    questionsList.innerHTML = `<p id="no-questions-message">Belum ada soal yang tersedia untuk ${level} - ${category}.</p>`;
                }
            }
            
            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const level = this.getAttribute('data-level');
                    const category = this.getAttribute('data-category');
                    const index = parseInt(this.getAttribute('data-index'));
                    editQuestion(level, category, index);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const level = this.getAttribute('data-level');
                    const category = this.getAttribute('data-category');
                    const index = parseInt(this.getAttribute('data-index'));
                    
                    if (confirm('Apakah Anda yakin ingin menghapus soal ini?')) {
                        deleteQuestion(level, category, index);
                    }
                });
            });
        }
        
        function editQuestion(level, category, index) {
            const question = QUESTION_BANK[level][category][index];
            
            // Fill the edit form
            document.getElementById('edit-question-level').value = level;
            document.getElementById('edit-question-category').value = category;
            document.getElementById('edit-question-text').value = question.question;
            
            // Extract option texts (remove "A. ", "B. ", etc.)
            document.getElementById('edit-option-a').value = question.options[0].substring(3);
            document.getElementById('edit-option-b').value = question.options[1].substring(3);
            document.getElementById('edit-option-c').value = question.options[2].substring(3);
            document.getElementById('edit-option-d').value = question.options[3].substring(3);
            document.getElementById('edit-option-e').value = question.options[4]?.substring(3) || '';
            
            document.getElementById('edit-correct-answer').value = question.correctAnswer;
            document.getElementById('edit-explanation').value = question.explanation;
            
            // Show image preview if exists
            const preview = document.getElementById('edit-question-image-preview');
            if (question.image) {
                preview.src = question.image;
                preview.style.display = 'block';
            } else {
                preview.style.display = 'none';
            }
            
            // Store original data for reference
            document.getElementById('edit-question-index').value = index;
            document.getElementById('edit-question-original-level').value = level;
            document.getElementById('edit-question-original-category').value = category;
            
            // Show the modal
            document.getElementById('edit-question-modal').style.display = 'flex';
        }
        
        function hideEditQuestionModal() {
            document.getElementById('edit-question-modal').style.display = 'none';
        }
        
        function saveEditedQuestion() {
            const originalLevel = document.getElementById('edit-question-original-level').value;
            const originalCategory = document.getElementById('edit-question-original-category').value;
            const newLevel = document.getElementById('edit-question-level').value;
            const newCategory = document.getElementById('edit-question-category').value;
            const index = parseInt(document.getElementById('edit-question-index').value);
            const questionText = document.getElementById('edit-question-text').value.trim();
            const options = [
                document.getElementById('edit-option-a').value.trim(),
                document.getElementById('edit-option-b').value.trim(),
                document.getElementById('edit-option-c').value.trim(),
                document.getElementById('edit-option-d').value.trim(),
                document.getElementById('edit-option-e').value.trim()
            ];
            const correctAnswer = parseInt(document.getElementById('edit-correct-answer').value);
            const explanation = document.getElementById('edit-explanation').value.trim();
            const imageFile = document.getElementById('edit-question-image').files[0];
            
            // Validate inputs
            if (!questionText) {
                alert('Pertanyaan tidak boleh kosong');
                return;
            }
            
            if (options.some(opt => !opt)) {
                alert('Semua opsi jawaban harus diisi');
                return;
            }
            
            if (!explanation) {
                alert('Penjelasan tidak boleh kosong');
                return;
            }
            
            // Create updated question
            const updatedQuestion = {
                question: questionText,
                options: options.map((opt, i) => `${String.fromCharCode(65 + i)}. ${opt}`),
                correctAnswer: correctAnswer,
                explanation: explanation,
                image: QUESTION_BANK[originalLevel][originalCategory][index].image // Keep original image by default
            };
            
            // Process new image if uploaded
            if (imageFile) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    updatedQuestion.image = event.target.result;
                    
                    // If level or category changed, remove from old and add to new
                    if (originalLevel !== newLevel || originalCategory !== newCategory) {
                        QUESTION_BANK[originalLevel][originalCategory].splice(index, 1);
                        QUESTION_BANK[newLevel][newCategory].push(updatedQuestion);
                    } else {
                        // Just update the question
                        QUESTION_BANK[originalLevel][originalCategory][index] = updatedQuestion;
                    }
                    
                    // Save to localStorage
                    saveQuestionBank();
                    
                    // Refresh questions list
                    filterQuestions();
                    
                    // Hide modal
                    hideEditQuestionModal();
                    
                    alert('Perubahan soal berhasil disimpan!');
                };
                reader.readAsDataURL(imageFile);
            } else {
                // If level or category changed, remove from old and add to new
                if (originalLevel !== newLevel || originalCategory !== newCategory) {
                    QUESTION_BANK[originalLevel][originalCategory].splice(index, 1);
                    QUESTION_BANK[newLevel][newCategory].push(updatedQuestion);
                } else {
                    // Just update the question
                    QUESTION_BANK[originalLevel][originalCategory][index] = updatedQuestion;
                }
                
                // Save to localStorage
                saveQuestionBank();
                
                // Refresh questions list
                filterQuestions();
                
                // Hide modal
                hideEditQuestionModal();
                
                alert('Perubahan soal berhasil disimpan!');
            }
        }
        
        function deleteQuestion(level, category, index) {
            // Remove question from the array
            QUESTION_BANK[level][category].splice(index, 1);
            
            // Save to localStorage
            saveQuestionBank();
            
            // Refresh questions list
            filterQuestions();
            
            alert('Soal berhasil dihapus!');
        }
        
        function loadParticipantsData() {
            const tableBody = document.getElementById('participants-table-body');
            tableBody.innerHTML = '';
            
            if (participantsData.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="10" style="text-align: center;">Belum ada data peserta</td></tr>';
                return;
            }
            
            // Sort by date (newest first)
            const sortedData = [...participantsData].sort((a, b) => 
                new Date(b.examDate) - new Date(a.examDate));
            
            sortedData.forEach((participant, index) => {
                const date = new Date(participant.examDate);
                const dateStr = date.toLocaleDateString('id-ID', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                const row = document.createElement('tr');
                row.dataset.index = index;
                row.innerHTML = `
                    <td>
                        <input type="checkbox" class="select-checkbox" data-index="${index}" onchange="toggleParticipantSelection(${index})">
                    </td>
                    <td>${dateStr}</td>
                    <td>${participant.fullname}</td>
                    <td>${participant.studentId || '-'}</td>
                    <td>Pelajar</td>
                    <td>${participant.level || '-'}</td>
                    <td>${participant.grade ? `Kelas ${participant.grade}` : '-'}</td>
                    <td>${participant.subject || '-'}</td>
                    <td>${participant.score}%</td>
                    <td>${participant.certificateCode || '-'}</td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Reset selected participants
            selectedParticipants = [];
            updateParticipantActionButtons();
        }
        
        function toggleParticipantSelection(index) {
            const checkbox = document.querySelector(`.select-checkbox[data-index="${index}"]`);
            if (checkbox.checked) {
                if (!selectedParticipants.includes(index)) {
                    selectedParticipants.push(index);
                }
            } else {
                selectedParticipants = selectedParticipants.filter(i => i !== index);
            }
            
            // Update select all checkbox
            updateSelectAllCheckbox();
            
            // Update action buttons
            updateParticipantActionButtons();
        }
        
        function toggleSelectAllParticipants() {
            const selectAllCheckbox = document.getElementById('select-all-checkbox');
            const checkboxes = document.querySelectorAll('.select-checkbox');
            
            selectAllCheckbox.checked = !selectAllCheckbox.checked;
            const isChecked = selectAllCheckbox.checked;
            
            checkboxes.forEach(checkbox => {
                checkbox.checked = isChecked;
                const index = parseInt(checkbox.dataset.index);
                
                if (isChecked) {
                    if (!selectedParticipants.includes(index)) {
                        selectedParticipants.push(index);
                    }
                } else {
                    selectedParticipants = selectedParticipants.filter(i => i !== index);
                }
            });
            
            // Update action buttons
            updateParticipantActionButtons();
        }
        
        function updateSelectAllCheckbox() {
            const checkboxes = document.querySelectorAll('.select-checkbox');
            const selectAllCheckbox = document.getElementById('select-all-checkbox');
            
            if (checkboxes.length === 0) {
                selectAllCheckbox.checked = false;
                return;
            }
            
            const allChecked = Array.from(checkboxes).every(checkbox => checkbox.checked);
            selectAllCheckbox.checked = allChecked;
        }
        
        function updateParticipantActionButtons() {
            const hasSelection = selectedParticipants.length > 0;
            
            document.getElementById('edit-selected-participants').disabled = !hasSelection;
            document.getElementById('delete-selected-participants').disabled = !hasSelection;
        }
        
        function editSelectedParticipants() {
            if (selectedParticipants.length === 0) return;
            
            // For now, we'll just edit the first selected participant
            // In a real app, you might want to implement bulk editing
            const index = selectedParticipants[0];
            editParticipant(index);
        }
        
        function editParticipant(index) {
            const participant = participantsData[index];
            
            // Fill the edit form
            document.getElementById('edit-fullname').value = participant.fullname;
            
            // Set status to student (only option now)
            document.getElementById('edit-status-student').checked = true;
            document.getElementById('edit-student-fields').style.display = 'block';
            
            // Fill student fields
            document.getElementById('edit-school-name').value = participant.school || '';
            document.getElementById('edit-student-id').value = participant.studentId || '';
            
            // Set purpose
            if (participant.purpose) {
                const purposeRadio = document.querySelector(`input[name="edit-purpose"][value="${participant.purpose}"]`);
                if (purposeRadio) purposeRadio.checked = true;
            }
            
            // Set level
            if (participant.level) {
                const levelRadio = document.querySelector(`input[name="edit-level"][value="${participant.level}"]`);
                if (levelRadio) levelRadio.checked = true;
                
                // Show grade selection
                showEditGradeSelection();
                
                // Set grade
                if (participant.grade) {
                    const gradeRadio = document.querySelector(`input[name="edit-grade"][value="${participant.grade}"]`);
                    if (gradeRadio) gradeRadio.checked = true;
                }
            }
            
            // Set subject
            if (participant.subject) {
                document.getElementById('edit-subject').value = participant.subject;
            }
            
            // Set score
            document.getElementById('edit-score').value = participant.score;
            
            // Set certificate code
            document.getElementById('edit-certificate-code').value = participant.certificateCode || '-';
            
            // Store index for saving
            document.getElementById('edit-participant-index').value = index;
            
            // Show the modal
            document.getElementById('edit-participant-modal').style.display = 'flex';
        }
        
        function toggleEditParticipantFields() {
            // Only student status is available now
            document.getElementById('edit-student-fields').style.display = 'block';
        }
        
        function showEditGradeSelection() {
            const level = document.querySelector('input[name="edit-level"]:checked')?.value;
            const gradeOptions = document.getElementById('edit-grade-options');
            
            // Clear previous options
            gradeOptions.innerHTML = '';
            
            if (!level) return;
            
            // Add options based on level
            if (level === 'SD') {
                addEditGradeOption('edit-grade-4', 'Kelas <span class="roman">IV</span>', '4');
                addEditGradeOption('edit-grade-5', 'Kelas <span class="roman">V</span>', '5');
                addEditGradeOption('edit-grade-6', 'Kelas <span class="roman">VI</span>', '6');
            } else if (level === 'SMP') {
                addEditGradeOption('edit-grade-7', 'Kelas <span class="roman">VII</span>', '7');
                addEditGradeOption('edit-grade-8', 'Kelas <span class="roman">VIII</span>', '8');
                addEditGradeOption('edit-grade-9', 'Kelas <span class="roman">IX</span>', '9');
            } else if (level === 'SMA/SMK') {
                addEditGradeOption('edit-grade-10', 'Kelas <span class="roman">X</span>', '10');
                addEditGradeOption('edit-grade-11', 'Kelas <span class="roman">XI</span>', '11');
                addEditGradeOption('edit-grade-12', 'Kelas <span class="roman">XII</span>', '12');
            }
        }
        
        function addEditGradeOption(id, label, value) {
            const container = document.getElementById('edit-grade-options');
            
            const radio = document.createElement('input');
            radio.type = 'radio';
            radio.id = id;
            radio.name = 'edit-grade';
            radio.value = value;
            radio.className = 'radio-option';
            
            const radioLabel = document.createElement('label');
            radioLabel.htmlFor = id;
            radioLabel.className = 'radio-label';
            radioLabel.innerHTML = label;
            
            container.appendChild(radio);
            container.appendChild(radioLabel);
        }
        
        function saveEditedParticipant() {
            const index = document.getElementById('edit-participant-index').value;
            if (!index) return;
            
            const participant = participantsData[index];
            
            // Update participant data
            participant.fullname = document.getElementById('edit-fullname').value.trim();
            participant.status = 'pelajar';
            participant.school = document.getElementById('edit-school-name').value.trim();
            participant.studentId = document.getElementById('edit-student-id').value.trim();
            participant.purpose = document.querySelector('input[name="edit-purpose"]:checked')?.value || '';
            participant.level = document.querySelector('input[name="edit-level"]:checked')?.value || '';
            participant.grade = document.querySelector('input[name="edit-grade"]:checked')?.value || '';
            participant.subject = document.getElementById('edit-subject').value;
            participant.score = parseInt(document.getElementById('edit-score').value);
            
            // Save to localStorage
            saveParticipantsData();
            
            // Reload participants data
            loadParticipantsData();
            
            // Hide modal
            hideEditParticipantModal();
            
            alert('Perubahan data peserta berhasil disimpan!');
        }
        
        function hideEditParticipantModal() {
            document.getElementById('edit-participant-modal').style.display = 'none';
        }
        
        function deleteSelectedParticipants() {
            if (selectedParticipants.length === 0) return;
            
            if (!confirm(`Apakah Anda yakin ingin menghapus ${selectedParticipants.length} peserta terpilih?`)) {
                return;
            }
            
            // Sort in descending order to avoid index issues when deleting
            const sortedIndices = [...selectedParticipants].sort((a, b) => b - a);
            
            // Delete participants
            sortedIndices.forEach(index => {
                participantsData.splice(index, 1);
            });
            
            // Save to localStorage
            saveParticipantsData();
            
            // Reload participants data
            loadParticipantsData();
            
            alert(`${sortedIndices.length} peserta berhasil dihapus!`);
        }
        
        function searchParticipants() {
            const searchTerm = document.getElementById('participant-search').value.toLowerCase();
            const rows = document.querySelectorAll('#participants-table-body tr');
            
            rows.forEach(row => {
                const index = parseInt(row.dataset.index);
                const participant = participantsData[index];
                const rowText = `
                    ${participant.fullname.toLowerCase()} 
                    ${participant.studentId || ''} 
                    ${participant.certificateCode || ''}
                `;
                
                if (rowText.includes(searchTerm)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }
        
        function validateCertificate() {
            const code = document.getElementById('certificate-code-input').value.trim();
            const validationResult = document.getElementById('validation-result');
            
            if (!code) {
                alert('Silakan masukkan kode sertifikat');
                return;
            }
            
            // Find participant with this certificate code
            const participant = participantsData.find(p => p.certificateCode === code);
            
            if (participant) {
                validationResult.innerHTML = `
                    <p class="valid-certificate">Sertifikat Valid!</p>
                    <p>Nama: ${participant.fullname}</p>
                    <p>Status: Pelajar</p>
                    <p>Tingkat: ${participant.level || '-'}</p>
                    <p>Kelas: ${participant.grade ? `Kelas ${participant.grade}` : '-'}</p>
                    <p>Mata Ujian: ${participant.subject || '-'}</p>
                    <p>Nilai: ${participant.score}%</p>
                    <p>Tanggal Ujian: ${new Date(participant.examDate).toLocaleDateString('id-ID')}</p>
                `;
                validationResult.style.display = 'block';
            } else {
                validationResult.innerHTML = '<p class="invalid-certificate">Sertifikat Tidak Valid!</p>';
                validationResult.style.display = 'block';
            }
        }
        
        function saveCodes() {
            const newLoginCode = document.getElementById('new-login-code').value;
            const newQuestionBankCode = document.getElementById('new-question-bank-code').value;
            const newAdminCode = document.getElementById('new-admin-code').value;
            
            if (newLoginCode) {
                adminSettings.loginCode = newLoginCode;
                document.getElementById('new-login-code').value = '';
            }
            
            if (newQuestionBankCode) {
                adminSettings.questionBankCode = newQuestionBankCode;
                document.getElementById('new-question-bank-code').value = '';
            }
            
            if (newAdminCode) {
                adminSettings.adminCode = newAdminCode;
                document.getElementById('new-admin-code').value = '';
            }
            
            // Save to localStorage
            saveAdminSettings();
            
            alert('Kode berhasil diubah!');
        }
        
        function saveContent() {
            const greetingMessage = document.getElementById('greeting-message-input').value;
            const adminMessage = document.getElementById('admin-message-input').value;
            const chairmanName = document.getElementById('chairman-name').value;
            
            // Update admin settings
            adminSettings.greetingMessage = greetingMessage;
            adminSettings.adminMessage = adminMessage;
            adminSettings.chairmanName = chairmanName;
            
            // Update UI
            document.getElementById('greeting-text').textContent = greetingMessage;
            document.getElementById('admin-message').textContent = adminMessage;
            
            // Save to localStorage
            saveAdminSettings();
            
            alert('Perubahan konten berhasil disimpan!');
        }
        
        function saveSettings() {
            const examDuration = parseInt(document.getElementById('exam-duration').value);
            const questionCount = parseInt(document.getElementById('question-count').value);
            const randomizeQuestions = document.getElementById('randomize-questions').checked;
            
            // Update admin settings
            adminSettings.examDuration = examDuration;
            adminSettings.questionCount = questionCount;
            adminSettings.randomizeQuestions = randomizeQuestions;
            
            // Update subject toggles
            adminSettings.enabledSubjects = {
                IPA: document.getElementById('toggle-science').checked,
                IPS: document.getElementById('toggle-social').checked
            };
            
            // Save to localStorage
            saveAdminSettings();
            
            alert('Pengaturan berhasil disimpan!');
        }
    </script>
</body>
</html>
